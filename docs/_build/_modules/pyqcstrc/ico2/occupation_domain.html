<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../../">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>pyqcstrc.ico2.occupation_domain &mdash; PyQCstrc 0.0.2a01 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../../../_static/css/theme.css?v=19f00094" />

  
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../../_static/jquery.js?v=5d32c60e"></script>
        <script src="../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../../../_static/documentation_options.js?v=c4b47ef7"></script>
        <script src="../../../_static/doctools.js?v=9a2dae69"></script>
        <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../index.html" class="icon icon-home">
            PyQCstrc
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../../install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../examples/index.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../modules/index.html">API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../changelog.html">Changelog</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">PyQCstrc</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../index.html">Module code</a></li>
      <li class="breadcrumb-item active">pyqcstrc.ico2.occupation_domain</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for pyqcstrc.ico2.occupation_domain</h1><div class="highlight"><pre>
<span></span><span class="ch">#!/usr/bin/env python3</span>
<span class="c1"># -*- coding: utf-8 -*-</span>
<span class="c1">#</span>
<span class="c1"># PyQCstrc - Python library for Quasi-Crystal structure</span>
<span class="c1"># Copyright (c) 2021 Tsunetomo Yamada &lt;tsunetomo.yamada@rs.tus.ac.jp&gt;</span>
<span class="c1">#</span>
<span class="kn">import</span> <span class="nn">timeit</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="c1">#sys.path.append(&#39;.&#39;)</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="k">try</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">pyqcstrc.ico2.math1</span> <span class="k">as</span> <span class="nn">math1</span>
    <span class="kn">import</span> <span class="nn">pyqcstrc.ico2.utils</span> <span class="k">as</span> <span class="nn">utils</span>
    <span class="kn">import</span> <span class="nn">pyqcstrc.ico2.numericalc</span> <span class="k">as</span> <span class="nn">numericalc</span>
    <span class="kn">import</span> <span class="nn">pyqcstrc.ico2.symmetry</span> <span class="k">as</span> <span class="nn">symmetry</span>
    <span class="kn">import</span> <span class="nn">pyqcstrc.ico2.intsct</span> <span class="k">as</span> <span class="nn">intsct</span>
<span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;import error</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="n">TAU</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span><span class="o">/</span><span class="mf">2.0</span>

<div class="viewcode-block" id="volume">
<a class="viewcode-back" href="../../../pyqcstrc.ico2.html#pyqcstrc.ico2.occupation_domain.volume">[docs]</a>
<span class="k">def</span> <span class="nf">volume</span><span class="p">(</span><span class="n">obj</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">utils</span><span class="o">.</span><span class="n">obj_volume_6d</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span></div>

    
<div class="viewcode-block" id="symmetric">
<a class="viewcode-back" href="../../../pyqcstrc.ico2.html#pyqcstrc.ico2.occupation_domain.symmetric">[docs]</a>
<span class="k">def</span> <span class="nf">symmetric</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span><span class="n">centre</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Generate symmterical occupation domain by symmetric elements of m-3-5 on the asymmetric unit.</span>
<span class="sd">    </span>
<span class="sd">    Args:</span>
<span class="sd">        obj (numpy.ndarray):</span>
<span class="sd">            Asymmetric unit of the occupation domain</span>
<span class="sd">            The shape is (num,4,6,3), where num=numbre_of_tetrahedron.</span>
<span class="sd">        centre (numpy.ndarray):</span>
<span class="sd">            6d coordinate of the symmetric centre.</span>
<span class="sd">            The shape is (6,3)</span>
<span class="sd">    </span>
<span class="sd">    Returns:</span>
<span class="sd">        Symmetric occupation domains (numpy.ndarray):</span>
<span class="sd">            The shape is (num,4,6,3), where num=numbre_of_tetrahedron.</span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">obj</span><span class="o">.</span><span class="n">ndim</span><span class="o">==</span><span class="mi">3</span> <span class="ow">or</span> <span class="n">obj</span><span class="o">.</span><span class="n">ndim</span><span class="o">==</span><span class="mi">4</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">symmetry</span><span class="o">.</span><span class="n">generator_obj_symmetric_tetrahedron</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span><span class="n">centre</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;object has an incorrect shape!&#39;</span><span class="p">)</span>
        <span class="k">return</span> </div>

    
<div class="viewcode-block" id="symmetric_0">
<a class="viewcode-back" href="../../../pyqcstrc.ico2.html#pyqcstrc.ico2.occupation_domain.symmetric_0">[docs]</a>
<span class="k">def</span> <span class="nf">symmetric_0</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span><span class="n">centre</span><span class="p">,</span><span class="n">indx_symop</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Generate symmterical occupation domain by symmetric elements of m-3-5 on the asymmetric unit.</span>
<span class="sd">    </span>
<span class="sd">    Args:</span>
<span class="sd">        obj (numpy.ndarray):</span>
<span class="sd">            Asymmetric unit of the occupation domain</span>
<span class="sd">            The shape is (num,4,6,3), where num=numbre_of_tetrahedron.</span>
<span class="sd">        centre (numpy.ndarray):</span>
<span class="sd">            6d coordinate of the symmetric centre.</span>
<span class="sd">            The shape is (6,3)</span>
<span class="sd">    </span>
<span class="sd">    Returns:</span>
<span class="sd">        Symmetric occupation domains (numpy.ndarray):</span>
<span class="sd">            The shape is (num,4,6,3), where num=numbre_of_tetrahedron.</span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">obj</span><span class="o">.</span><span class="n">ndim</span><span class="o">==</span><span class="mi">3</span> <span class="ow">or</span> <span class="n">obj</span><span class="o">.</span><span class="n">ndim</span><span class="o">==</span><span class="mi">4</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">symmetry</span><span class="o">.</span><span class="n">generator_obj_symmetric_tetrahedron_0</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span><span class="n">centre</span><span class="p">,</span><span class="n">indx_symop</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;object has an incorrect shape!&#39;</span><span class="p">)</span>
        <span class="k">return</span> </div>


<div class="viewcode-block" id="shift">
<a class="viewcode-back" href="../../../pyqcstrc.ico2.html#pyqcstrc.ico2.occupation_domain.shift">[docs]</a>
<span class="k">def</span> <span class="nf">shift</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span><span class="n">shift</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Shift the occupation domain.</span>
<span class="sd">    </span>
<span class="sd">    Args:</span>
<span class="sd">        obj (numpy.ndarray):</span>
<span class="sd">            The occupation domain</span>
<span class="sd">            The shape is (num,4,6,3), where num=numbre_of_tetrahedron.</span>
<span class="sd">        shift (numpy.ndarray):</span>
<span class="sd">            6d coordinate to which the occupation domain is shifted.</span>
<span class="sd">            The shape is (6,3)</span>
<span class="sd">        verbose (int):</span>
<span class="sd">            verbose = 0 (silent, default)</span>
<span class="sd">            verbose = 1 (normal)</span>
<span class="sd">    </span>
<span class="sd">    Returns:</span>
<span class="sd">        Shifted occupation domains (numpy.ndarray):</span>
<span class="sd">            The shape is (num,4,6,3), where num=numbre_of_tetrahedron.</span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">utils</span><span class="o">.</span><span class="n">shift_object</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">shift</span><span class="p">)</span></div>


<div class="viewcode-block" id="write">
<a class="viewcode-back" href="../../../pyqcstrc.ico2.html#pyqcstrc.ico2.occupation_domain.write">[docs]</a>
<span class="k">def</span> <span class="nf">write</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">,</span><span class="n">basename</span><span class="o">=</span><span class="s1">&#39;tmp&#39;</span><span class="p">,</span><span class="nb">format</span><span class="o">=</span><span class="s1">&#39;xyz&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">select</span><span class="o">=</span><span class="s1">&#39;tetrahedron&#39;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Export occupation domains.</span>
<span class="sd">    </span>
<span class="sd">    Args:</span>
<span class="sd">        obj (numpy.ndarray): the occupation domain</span>
<span class="sd">            The shape is (num,4,6,3), where num=numbre_of_tetrahedron.</span>
<span class="sd">        path (str): Path of the output XYZ file</span>
<span class="sd">        basename (str): Basename of the output XYZ file</span>
<span class="sd">        format (str): format of output file</span>
<span class="sd">            format = &#39;xyz&#39; (default)</span>
<span class="sd">            format = &#39;vesta&#39;</span>
<span class="sd">        color (str)</span>
<span class="sd">            one of the characters {&#39;k&#39;,&#39;r&#39;,&#39;b&#39;,&#39;p&#39;}, which are short-hand notations </span>
<span class="sd">            for shades of black, red, blue, and pink, in case where &#39;vesta&#39; format is</span>
<span class="sd">            selected (default, color = &#39;k&#39;).</span>
<span class="sd">    Returns:</span>
<span class="sd">        int: 0 (succeed), 1 (fail)</span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">path</span><span class="p">)</span><span class="o">==</span><span class="kc">False</span><span class="p">:</span>
        <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">pass</span>
        
    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">obj</span><span class="o">==</span><span class="kc">None</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;    Empty OD&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="mi">1</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">format</span><span class="o">==</span><span class="s1">&#39;vesta&#39;</span> <span class="ow">or</span> <span class="nb">format</span><span class="o">==</span><span class="s1">&#39;v&#39;</span> <span class="ow">or</span> <span class="nb">format</span><span class="o">==</span><span class="s1">&#39;VESTA&#39;</span><span class="p">:</span>
            <span class="n">write_vesta</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">basename</span><span class="p">,</span> <span class="n">color</span><span class="p">,</span> <span class="n">select</span><span class="o">=</span><span class="s1">&#39;normal&#39;</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">format</span> <span class="o">==</span> <span class="s1">&#39;xyz&#39;</span><span class="p">:</span>
            <span class="n">write_xyz</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">basename</span><span class="p">,</span> <span class="n">select</span><span class="p">,</span> <span class="n">verbose</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">return</span> <span class="mi">0</span></div>

    
<div class="viewcode-block" id="write_vesta">
<a class="viewcode-back" href="../../../pyqcstrc.ico2.html#pyqcstrc.ico2.occupation_domain.write_vesta">[docs]</a>
<span class="k">def</span> <span class="nf">write_vesta</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span><span class="n">path</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">,</span><span class="n">basename</span><span class="o">=</span><span class="s1">&#39;tmp&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span><span class="n">select</span><span class="o">=</span><span class="s1">&#39;normal&#39;</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Export occupation domains in VESTA format.</span>
<span class="sd">    </span>
<span class="sd">    Args:</span>
<span class="sd">        obj (numpy.ndarray): the occupation domain</span>
<span class="sd">            The shape is (num,4,6,3), where num=numbre_of_tetrahedron.</span>
<span class="sd">        path (str): Path of the output XYZ file</span>
<span class="sd">        basename (str): Basename of the output XYZ file</span>
<span class="sd">        color (str)</span>
<span class="sd">            one of the characters {&#39;k&#39;,&#39;r&#39;,&#39;b&#39;,&#39;p&#39;}, which are short-hand notations </span>
<span class="sd">            for shades of black, red, blue, and pink, in case where &#39;vesta&#39; format is</span>
<span class="sd">            selected (default, color = &#39;k&#39;).</span>
<span class="sd">        select (str):&#39;simple&#39; or &#39;normal&#39;</span>
<span class="sd">            &#39;simple&#39;: Merging tetrahedra into one single objecte</span>
<span class="sd">            &#39;normal&#39;: Each tetrahedron is set as single objecte (large file)</span>
<span class="sd">            &#39;podatm&#39;: same as &#39;simple&#39; but return &quot;vertices&quot; necessary to input </span>
<span class="sd">            (default, select = &#39;normal&#39;)</span>
<span class="sd">    Returns:</span>
<span class="sd">        int: 0 (succeed), 1 (fail) when select = &#39;simple&#39; or &#39;normal&#39;.</span>
<span class="sd">        ndarray: vertices, when select = &#39;podatm&#39;.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">path</span><span class="p">)</span><span class="o">==</span><span class="kc">False</span><span class="p">:</span>
        <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">pass</span>
    
    <span class="k">def</span> <span class="nf">colors</span><span class="p">(</span><span class="n">code</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">code</span><span class="o">==</span><span class="s1">&#39;red&#39;</span> <span class="ow">or</span> <span class="n">code</span><span class="o">==</span><span class="s1">&#39;r&#39;</span><span class="p">:</span>
            <span class="n">a</span> <span class="o">=</span> <span class="p">[</span><span class="mi">255</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">elif</span> <span class="n">code</span><span class="o">==</span><span class="s1">&#39;blue&#39;</span> <span class="ow">or</span> <span class="n">code</span><span class="o">==</span><span class="s1">&#39;b&#39;</span><span class="p">:</span>
            <span class="n">a</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">255</span><span class="p">]</span>
        <span class="k">elif</span> <span class="n">code</span><span class="o">==</span><span class="s1">&#39;black&#39;</span> <span class="ow">or</span> <span class="n">code</span><span class="o">==</span><span class="s1">&#39;k&#39;</span><span class="p">:</span>
            <span class="n">a</span> <span class="o">=</span> <span class="p">[</span><span class="mi">127</span><span class="p">,</span><span class="mi">127</span><span class="p">,</span><span class="mi">127</span><span class="p">]</span>
        <span class="k">elif</span> <span class="n">code</span><span class="o">==</span><span class="s1">&#39;pink&#39;</span> <span class="ow">or</span> <span class="n">code</span><span class="o">==</span><span class="s1">&#39;p&#39;</span><span class="p">:</span>
            <span class="n">a</span> <span class="o">=</span> <span class="p">[</span><span class="mi">255</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">255</span><span class="p">]</span>
        <span class="k">elif</span> <span class="n">code</span><span class="o">==</span><span class="s1">&#39;lime&#39;</span> <span class="ow">or</span> <span class="n">code</span><span class="o">==</span><span class="s1">&#39;l&#39;</span><span class="p">:</span>
            <span class="n">a</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">255</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">elif</span> <span class="n">code</span><span class="o">==</span><span class="s1">&#39;yellow&#39;</span> <span class="ow">or</span> <span class="n">code</span><span class="o">==</span><span class="s1">&#39;y&#39;</span><span class="p">:</span>
            <span class="n">a</span> <span class="o">=</span> <span class="p">[</span><span class="mi">255</span><span class="p">,</span><span class="mi">255</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">elif</span> <span class="n">code</span><span class="o">==</span><span class="s1">&#39;cyan&#39;</span> <span class="ow">or</span> <span class="n">code</span><span class="o">==</span><span class="s1">&#39;c&#39;</span><span class="p">:</span>
            <span class="n">a</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">255</span><span class="p">,</span><span class="mi">255</span><span class="p">]</span>
        <span class="k">elif</span> <span class="n">code</span><span class="o">==</span><span class="s1">&#39;silver&#39;</span> <span class="ow">or</span> <span class="n">code</span><span class="o">==</span><span class="s1">&#39;s&#39;</span><span class="p">:</span>
            <span class="n">a</span> <span class="o">=</span> <span class="p">[</span><span class="mi">192</span><span class="p">,</span><span class="mi">192</span><span class="p">,</span><span class="mi">192</span><span class="p">]</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">code</span><span class="p">)</span><span class="o">==</span><span class="mi">3</span><span class="p">:</span>
            <span class="n">a</span> <span class="o">=</span> <span class="n">code</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">a</span> <span class="o">=</span> <span class="p">[</span><span class="mi">127</span><span class="p">,</span><span class="mi">127</span><span class="p">,</span><span class="mi">127</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">a</span>
    
    <span class="n">file_name</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1">/</span><span class="si">%s</span><span class="s1">.vesta&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">path</span><span class="p">,</span><span class="n">basename</span><span class="p">)</span>
    <span class="n">f</span><span class="o">=</span><span class="nb">open</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1">&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">file_name</span><span class="p">),</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
    
    <span class="c1">#dmax=5.0</span>
    <span class="n">dmax</span><span class="o">=</span><span class="mf">10.0</span>
    
    <span class="k">if</span> <span class="n">select</span><span class="o">==</span><span class="s1">&#39;simple&#39;</span><span class="p">:</span>
        
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">obj</span><span class="o">==</span><span class="kc">None</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;no volume obj&#39;</span><span class="p">)</span>
            <span class="k">return</span> <span class="mi">0</span>
        
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># get independent edges</span>
            <span class="n">edges</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">generator_obj_edge</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">verbose</span><span class="p">)</span>
            <span class="c1"># get independent vertices of the edges</span>
            <span class="n">vertices</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">remove_doubling_in_perp_space</span><span class="p">(</span><span class="n">edges</span><span class="p">)</span>
        
            <span class="c1"># get bond pairs, [[distance, XXX, YYY],...]</span>
            <span class="n">pairs</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">i1</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">edges</span><span class="p">)):</span>
                <span class="n">dist</span><span class="o">=</span><span class="n">intsct</span><span class="o">.</span><span class="n">distance_in_perp_space</span><span class="p">(</span><span class="n">edges</span><span class="p">[</span><span class="n">i1</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="n">edges</span><span class="p">[</span><span class="n">i1</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
                <span class="n">a</span><span class="o">=</span><span class="p">[</span><span class="n">dist</span><span class="p">]</span>
                <span class="k">for</span> <span class="n">i2</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span>
                    <span class="k">for</span> <span class="n">i3</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">vertices</span><span class="p">)):</span>
                        <span class="n">tmp</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="n">edges</span><span class="p">[</span><span class="n">i1</span><span class="p">][</span><span class="n">i2</span><span class="p">],</span><span class="n">vertices</span><span class="p">[</span><span class="n">i3</span><span class="p">]])</span>
                        <span class="n">tmp</span><span class="o">=</span><span class="n">utils</span><span class="o">.</span><span class="n">remove_doubling_in_perp_space</span><span class="p">(</span><span class="n">tmp</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
                        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">tmp</span><span class="p">)</span><span class="o">==</span><span class="mi">1</span><span class="p">:</span>
                            <span class="n">a</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i3</span><span class="p">)</span>
                            <span class="k">break</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="k">pass</span>
                <span class="n">pairs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
        
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;#VESTA_FORMAT_VERSION 3.5.0</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">f</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;MOLECULE</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">TITLE&#39;</span><span class="p">,</span><span class="n">file</span><span class="o">=</span><span class="n">f</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1">/</span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">path</span><span class="p">,</span><span class="n">basename</span><span class="p">),</span> <span class="n">file</span><span class="o">=</span><span class="n">f</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;GROUP</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">1 1 Custom</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">SYMOP</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1"> 0.000000  0.000000  0.000000  1  0  0    0  1  0    0  0  1    1</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1"> -1.0 -1.0 -1.0  0 0 0  0 0 0  0 0 0</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">TRANM 0</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1"> 0.000000  0.000000  0.000000  1  0  0    0  1  0    0  0  1</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">LTRANSL</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1"> -1</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1"> 0.000000  0.000000  0.000000  0.000000  0.000000  0.000000</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">LORIENT</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1"> -1    0    0    0    0</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1"> 1.000000  0.000000  0.000000  1.000000  0.000000  0.000000</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1"> 0.000000  0.000000  1.000000  0.000000  0.000000  1.000000</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">LMATRIX</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1"> 1.000000  0.000000  0.000000  0.000000</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1"> 0.000000  1.000000  0.000000  0.000000</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1"> 0.000000  0.000000  1.000000  0.000000</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1"> 0.000000  0.000000  0.000000  1.000000</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1"> 0.000000  0.000000  0.000000</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">CELLP</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">  1.000000    1.000000    1.000000  90.000000  90.000000  90.000000</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">  0.000000    0.000000    0.000000    0.000000    0.000000    0.000000</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">STRUC&#39;</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">f</span><span class="p">)</span>
            <span class="n">i2</span><span class="o">=</span><span class="mi">0</span>
            <span class="k">for</span> <span class="n">vrtx</span> <span class="ow">in</span> <span class="n">vertices</span><span class="p">:</span>
                <span class="n">xyz</span> <span class="o">=</span> <span class="n">math1</span><span class="o">.</span><span class="n">projection3</span><span class="p">(</span><span class="n">vrtx</span><span class="p">)</span>
                <span class="n">xyz</span><span class="o">=</span><span class="n">numericalc</span><span class="o">.</span><span class="n">numerical_vector</span><span class="p">(</span><span class="n">xyz</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%4d</span><span class="s1"> A        A</span><span class="si">%d</span><span class="s1">  1.0000    </span><span class="si">%8.6f</span><span class="s1"> </span><span class="si">%8.6f</span><span class="s1"> </span><span class="si">%8.6f</span><span class="s1">        1&#39;</span><span class="o">%</span>\
                <span class="p">(</span><span class="n">i2</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">i2</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">xyz</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">xyz</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">xyz</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span> <span class="n">file</span><span class="o">=</span><span class="n">f</span><span class="p">)</span>
                <span class="n">i2</span><span class="o">+=</span><span class="mi">1</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;                             0.000000    0.000000    0.000000  0.00&#39;</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">f</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;  0 0 0 0 0 0 0</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">THERI 0&#39;</span><span class="p">,</span> <span class="n">file</span> <span class="o">=</span> <span class="n">f</span><span class="p">)</span>
            <span class="n">i2</span><span class="o">=</span><span class="mi">0</span>
            <span class="k">for</span> <span class="n">__</span> <span class="ow">in</span> <span class="n">vertices</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;  </span><span class="si">%d</span><span class="s1">        A</span><span class="si">%d</span><span class="s1">  1.000000&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">i2</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">i2</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span> <span class="n">file</span><span class="o">=</span><span class="n">f</span><span class="p">)</span>
                <span class="n">i2</span><span class="o">+=</span><span class="mi">1</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;  0 0 0</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">SHAPE</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">  0         0         0         0    0.000000  0    192    192    192    192</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">BOUND</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">         0          1        0          1        0          1</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">  0    0    0    0  0</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">SBOND&#39;</span><span class="p">,</span> <span class="n">file</span> <span class="o">=</span> <span class="n">f</span><span class="p">)</span>
            <span class="n">clr</span><span class="o">=</span><span class="n">colors</span><span class="p">(</span><span class="n">color</span><span class="p">)</span>
            <span class="n">i2</span><span class="o">=</span><span class="mi">0</span>
            <span class="k">for</span> <span class="n">pair</span> <span class="ow">in</span> <span class="n">pairs</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;  </span><span class="si">%d</span><span class="s1">   A</span><span class="si">%d</span><span class="s1">   A</span><span class="si">%d</span><span class="s1">   </span><span class="si">%8.6f</span><span class="s1">   </span><span class="si">%8.6f</span><span class="s1">  0  1  1  1  2  0.250  2.000 </span><span class="si">%3d</span><span class="s1"> </span><span class="si">%3d</span><span class="s1"> </span><span class="si">%3d</span><span class="s1">&#39;</span><span class="o">%</span><span class="p">(</span>\
                <span class="n">i2</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">pair</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">pair</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">pair</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">pair</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">clr</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">clr</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">clr</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span> <span class="n">file</span><span class="o">=</span><span class="n">f</span><span class="p">)</span>
                <span class="n">i2</span><span class="o">+=</span><span class="mi">1</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;  0 0 0 0</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">SITET&#39;</span><span class="p">,</span> <span class="n">file</span> <span class="o">=</span> <span class="n">f</span><span class="p">)</span>
            <span class="n">i2</span><span class="o">=</span><span class="mi">0</span>
            <span class="k">for</span> <span class="n">__</span> <span class="ow">in</span> <span class="n">vertices</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;    </span><span class="si">%d</span><span class="s1">        A</span><span class="si">%d</span><span class="s1">  0.100  76  76  76  76  76  76 204  0&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">i2</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">i2</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span> <span class="n">file</span><span class="o">=</span><span class="n">f</span><span class="p">)</span>
                <span class="n">i2</span><span class="o">+=</span><span class="mi">1</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;  0 0 0 0 0 0</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">VECTR</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1"> 0 0 0 0 0</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">VECTT</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1"> 0 0 0 0 0</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">SPLAN</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">  0    0    0    0</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">LBLAT</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1"> -1</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">LBLSP</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1"> -1</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">DLATM</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1"> -1</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">DLBND</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1"> -1</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">DLPLY</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1"> -1</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">PLN2D</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">  0    0    0    0&#39;</span><span class="p">,</span> <span class="n">file</span> <span class="o">=</span> <span class="n">f</span><span class="p">)</span>
        
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;ATOMT</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">  1        A  0.0100  76  76  76  76  76  76 204</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">  0 0 0 0 0 0</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">SCENE</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">-0.538344 -0.838391  0.085359  0.000000</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">-0.362057  0.138632 -0.921789  0.000000</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1"> 0.760986 -0.527145 -0.378177  0.000000</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1"> 0.000000  0.000000  0.000000  1.000000</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">  0.000    0.000</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">  0.000</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">  1.320</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">HBOND 0 2</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">STYLE</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">DISPF 37753794</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">MODEL    0  1  0</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">SURFS    0  1  1</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">SECTS  32  1</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">FORMS    0  1</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">ATOMS    0  0  1</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">BONDS    2</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">POLYS    1</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">VECTS 1.000000</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">FORMP</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">  1  1.0    0    0    0</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">ATOMP</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1"> 24  24    0  50  2.0    0</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">BONDP</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">  1  16  0.250  2.000 127 127 127</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">POLYP</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1"> 204 1  1.000 180 180 180</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">ISURF</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">  0    0    0    0</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">TEX3P</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">  1  0.00000E+00  1.00000E+00</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">SECTP</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">  1  5.00000E-01  5.00000E-01  0.00000E+00  0.00000E+00  0.00000E+00  0.00000E+00</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">CONTR</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1"> 0.1 -1 1 1 10 -1 2 5</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1"> 2 1 2 1</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">    0    0    0</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">    0    0    0</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">    0    0    0</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">    0    0    0</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">HKLPP</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1"> 192 1  1.000 255    0 255</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">UCOLP</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">    0    1  1.000    0    0    0</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">COMPS 0</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">LABEL 1     12  1.000 0</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">PROJT 0  0.962</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">BKGRC</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1"> 255 255 255</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">DPTHQ 1 -0.5000  3.5000</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">LIGHT0 1</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1"> 1.000000  0.000000  0.000000  0.000000</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1"> 0.000000  1.000000  0.000000  0.000000</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1"> 0.000000  0.000000  1.000000  0.000000</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1"> 0.000000  0.000000  0.000000  1.000000</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1"> 0.000000  0.000000 20.000000  0.000000</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1"> 0.000000  0.000000 -1.000000</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">  26  26  26 255</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1"> 179 179 179 255</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1"> 255 255 255 255</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">LIGHT1</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1"> 1.000000  0.000000  0.000000  0.000000</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1"> 0.000000  1.000000  0.000000  0.000000</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1"> 0.000000  0.000000  1.000000  0.000000</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1"> 0.000000  0.000000  0.000000  1.000000</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1"> 0.000000  0.000000 20.000000  0.000000</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1"> 0.000000  0.000000 -1.000000</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">    0    0    0    0</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">    0    0    0    0</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">    0    0    0    0</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">LIGHT2</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1"> 1.000000  0.000000  0.000000  0.000000</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1"> 0.000000  1.000000  0.000000  0.000000</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1"> 0.000000  0.000000  1.000000  0.000000</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1"> 0.000000  0.000000  0.000000  1.000000</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1"> 0.000000  0.000000 20.000000  0.000000</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1"> 0.000000  0.000000 -1.000000</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">    0    0    0    0</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">    0    0    0    0</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">    0    0    0    0</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">LIGHT3</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1"> 1.000000  0.000000  0.000000  0.000000</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1"> 0.000000  1.000000  0.000000  0.000000</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1"> 0.000000  0.000000  1.000000  0.000000</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1"> 0.000000  0.000000  0.000000  1.000000</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1"> 0.000000  0.000000 20.000000  0.000000</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1"> 0.000000  0.000000 -1.000000</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">    0    0    0    0</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">    0    0    0    0</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">    0    0    0    0</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">ATOMM</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1"> 204 204 204 255</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">  25.600</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">BONDM</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1"> 255 255 255 255</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1"> 128.000</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">POLYM</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1"> 255 255 255 255</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1"> 128.000</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">SURFM</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">    0    0    0 255</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1"> 128.000</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">FORMM</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1"> 255 255 255 255</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1"> 128.000</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">HKLPM</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1"> 255 255 255 255</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1"> 128.000&#39;</span><span class="p">,</span><span class="n">file</span> <span class="o">=</span> <span class="n">f</span><span class="p">)</span>
        
            <span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">verbose</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;    written in </span><span class="si">%s</span><span class="s1">&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">file_name</span><span class="p">))</span>
            <span class="k">return</span> <span class="mi">0</span>
        
    <span class="k">elif</span> <span class="n">select</span><span class="o">==</span><span class="s1">&#39;normal&#39;</span><span class="p">:</span>
        
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">obj</span><span class="o">==</span><span class="kc">None</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;no volume obj&#39;</span><span class="p">)</span>
            <span class="k">return</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;#VESTA_FORMAT_VERSION 3.5.0</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">f</span><span class="p">)</span>
            <span class="n">i1</span><span class="o">=</span><span class="mi">0</span>
            <span class="k">for</span> <span class="n">obj1</span> <span class="ow">in</span> <span class="n">obj</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;MOLECULE</span><span class="se">\</span>
<span class="s1">                </span><span class="se">\n</span><span class="s1">TITLE&#39;</span><span class="p">,</span><span class="n">file</span><span class="o">=</span><span class="n">f</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1">/</span><span class="si">%s</span><span class="s1">_</span><span class="si">%d</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">path</span><span class="p">,</span><span class="n">basename</span><span class="p">,</span><span class="n">i1</span><span class="p">),</span> <span class="n">file</span><span class="o">=</span><span class="n">f</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;GROUP</span><span class="se">\</span>
<span class="s1">                </span><span class="se">\n</span><span class="s1">1 1 Custom</span><span class="se">\</span>
<span class="s1">                </span><span class="se">\n</span><span class="s1">SYMOP</span><span class="se">\</span>
<span class="s1">                </span><span class="se">\n</span><span class="s1"> 0.000000  0.000000  0.000000  1  0  0    0  1  0    0  0  1    1</span><span class="se">\</span>
<span class="s1">                </span><span class="se">\n</span><span class="s1"> -1.0 -1.0 -1.0  0 0 0  0 0 0  0 0 0</span><span class="se">\</span>
<span class="s1">                </span><span class="se">\n</span><span class="s1">TRANM 0</span><span class="se">\</span>
<span class="s1">                </span><span class="se">\n</span><span class="s1"> 0.000000  0.000000  0.000000  1  0  0    0  1  0    0  0  1</span><span class="se">\</span>
<span class="s1">                </span><span class="se">\n</span><span class="s1">LTRANSL</span><span class="se">\</span>
<span class="s1">                </span><span class="se">\n</span><span class="s1"> -1</span><span class="se">\</span>
<span class="s1">                </span><span class="se">\n</span><span class="s1"> 0.000000  0.000000  0.000000  0.000000  0.000000  0.000000</span><span class="se">\</span>
<span class="s1">                </span><span class="se">\n</span><span class="s1">LORIENT</span><span class="se">\</span>
<span class="s1">                </span><span class="se">\n</span><span class="s1"> -1    0    0    0    0</span><span class="se">\</span>
<span class="s1">                </span><span class="se">\n</span><span class="s1"> 1.000000  0.000000  0.000000  1.000000  0.000000  0.000000</span><span class="se">\</span>
<span class="s1">                </span><span class="se">\n</span><span class="s1"> 0.000000  0.000000  1.000000  0.000000  0.000000  1.000000</span><span class="se">\</span>
<span class="s1">                </span><span class="se">\n</span><span class="s1">LMATRIX</span><span class="se">\</span>
<span class="s1">                </span><span class="se">\n</span><span class="s1"> 1.000000  0.000000  0.000000  0.000000</span><span class="se">\</span>
<span class="s1">                </span><span class="se">\n</span><span class="s1"> 0.000000  1.000000  0.000000  0.000000</span><span class="se">\</span>
<span class="s1">                </span><span class="se">\n</span><span class="s1"> 0.000000  0.000000  1.000000  0.000000</span><span class="se">\</span>
<span class="s1">                </span><span class="se">\n</span><span class="s1"> 0.000000  0.000000  0.000000  1.000000</span><span class="se">\</span>
<span class="s1">                </span><span class="se">\n</span><span class="s1"> 0.000000  0.000000  0.000000</span><span class="se">\</span>
<span class="s1">                </span><span class="se">\n</span><span class="s1">CELLP</span><span class="se">\</span>
<span class="s1">                </span><span class="se">\n</span><span class="s1">  1.000000    1.000000    1.000000  90.000000  90.000000  90.000000</span><span class="se">\</span>
<span class="s1">                </span><span class="se">\n</span><span class="s1">  0.000000    0.000000    0.000000    0.000000    0.000000    0.000000</span><span class="se">\</span>
<span class="s1">                </span><span class="se">\n</span><span class="s1">STRUC&#39;</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">f</span><span class="p">)</span>
                <span class="n">i2</span><span class="o">=</span><span class="mi">0</span>
                <span class="k">for</span> <span class="n">vertx</span> <span class="ow">in</span> <span class="n">obj1</span><span class="p">:</span>
                    <span class="n">xyz</span><span class="o">=</span><span class="n">math1</span><span class="o">.</span><span class="n">projection3</span><span class="p">(</span><span class="n">vertx</span><span class="p">)</span>
                    <span class="n">xyz</span><span class="o">=</span><span class="n">numericalc</span><span class="o">.</span><span class="n">numerical_vector</span><span class="p">(</span><span class="n">xyz</span><span class="p">)</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%4d</span><span class="s1"> Xx        Xx</span><span class="si">%d</span><span class="s1">  1.0000    </span><span class="si">%8.6f</span><span class="s1"> </span><span class="si">%8.6f</span><span class="s1"> </span><span class="si">%8.6f</span><span class="s1">        1&#39;</span><span class="o">%</span>\
                    <span class="p">(</span><span class="n">i2</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">i2</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">xyz</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">xyz</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">xyz</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span> <span class="n">file</span><span class="o">=</span><span class="n">f</span><span class="p">)</span>
                    <span class="n">i2</span><span class="o">+=</span><span class="mi">1</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;                             0.000000    0.000000    0.000000  0.00&#39;</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">f</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;  0 0 0 0 0 0 0</span><span class="se">\</span>
<span class="s1">                </span><span class="se">\n</span><span class="s1">THERI 0&#39;</span><span class="p">,</span> <span class="n">file</span> <span class="o">=</span> <span class="n">f</span><span class="p">)</span>
                <span class="n">i2</span><span class="o">=</span><span class="mi">0</span>
                <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">obj1</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;  </span><span class="si">%d</span><span class="s1">        Xx</span><span class="si">%d</span><span class="s1">  1.000000&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">i2</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">i2</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span> <span class="n">file</span><span class="o">=</span><span class="n">f</span><span class="p">)</span>
                    <span class="n">i2</span><span class="o">+=</span><span class="mi">1</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;  0 0 0</span><span class="se">\</span>
<span class="s1">                </span><span class="se">\n</span><span class="s1">SHAPE</span><span class="se">\</span>
<span class="s1">                </span><span class="se">\n</span><span class="s1">  0         0         0         0    0.000000  0    192    192    192    192</span><span class="se">\</span>
<span class="s1">                </span><span class="se">\n</span><span class="s1">BOUND</span><span class="se">\</span>
<span class="s1">                </span><span class="se">\n</span><span class="s1">         0          1        0          1        0          1</span><span class="se">\</span>
<span class="s1">                </span><span class="se">\n</span><span class="s1">  0    0    0    0  0</span><span class="se">\</span>
<span class="s1">                </span><span class="se">\n</span><span class="s1">SBOND&#39;</span><span class="p">,</span> <span class="n">file</span> <span class="o">=</span> <span class="n">f</span><span class="p">)</span>
                <span class="n">clr</span><span class="o">=</span><span class="n">colors</span><span class="p">(</span><span class="n">color</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;  1     Xx     Xx     0.00000     </span><span class="si">%3.2f</span><span class="s1">  0  1  1  0  2  0.250  2.000 </span><span class="si">%3d</span><span class="s1"> </span><span class="si">%3d</span><span class="s1"> </span><span class="si">%3d</span><span class="s1">&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">dmax</span><span class="p">,</span><span class="n">clr</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">clr</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">clr</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span> <span class="n">file</span><span class="o">=</span><span class="n">f</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;  0 0 0 0</span><span class="se">\</span>
<span class="s1">                </span><span class="se">\n</span><span class="s1">SITET&#39;</span><span class="p">,</span> <span class="n">file</span> <span class="o">=</span> <span class="n">f</span><span class="p">)</span>
                <span class="n">i2</span><span class="o">=</span><span class="mi">0</span>
                <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">obj1</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;    </span><span class="si">%d</span><span class="s1">        Xx</span><span class="si">%d</span><span class="s1">  0.0100  76  76  76  76  76  76 204  0&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">i2</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">i2</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span> <span class="n">file</span><span class="o">=</span><span class="n">f</span><span class="p">)</span>
                    <span class="n">i2</span><span class="o">+=</span><span class="mi">1</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;  0 0 0 0 0 0</span><span class="se">\</span>
<span class="s1">                </span><span class="se">\n</span><span class="s1">VECTR</span><span class="se">\</span>
<span class="s1">                </span><span class="se">\n</span><span class="s1"> 0 0 0 0 0</span><span class="se">\</span>
<span class="s1">                </span><span class="se">\n</span><span class="s1">VECTT</span><span class="se">\</span>
<span class="s1">                </span><span class="se">\n</span><span class="s1"> 0 0 0 0 0</span><span class="se">\</span>
<span class="s1">                </span><span class="se">\n</span><span class="s1">SPLAN</span><span class="se">\</span>
<span class="s1">                </span><span class="se">\n</span><span class="s1">  0    0    0    0</span><span class="se">\</span>
<span class="s1">                </span><span class="se">\n</span><span class="s1">LBLAT</span><span class="se">\</span>
<span class="s1">                </span><span class="se">\n</span><span class="s1"> -1</span><span class="se">\</span>
<span class="s1">                </span><span class="se">\n</span><span class="s1">LBLSP</span><span class="se">\</span>
<span class="s1">                </span><span class="se">\n</span><span class="s1"> -1</span><span class="se">\</span>
<span class="s1">                </span><span class="se">\n</span><span class="s1">DLATM</span><span class="se">\</span>
<span class="s1">                </span><span class="se">\n</span><span class="s1"> -1</span><span class="se">\</span>
<span class="s1">                </span><span class="se">\n</span><span class="s1">DLBND</span><span class="se">\</span>
<span class="s1">                </span><span class="se">\n</span><span class="s1"> -1</span><span class="se">\</span>
<span class="s1">                </span><span class="se">\n</span><span class="s1">DLPLY</span><span class="se">\</span>
<span class="s1">                </span><span class="se">\n</span><span class="s1"> -1</span><span class="se">\</span>
<span class="s1">                </span><span class="se">\n</span><span class="s1">PLN2D</span><span class="se">\</span>
<span class="s1">                </span><span class="se">\n</span><span class="s1">  0    0    0    0&#39;</span><span class="p">,</span> <span class="n">file</span> <span class="o">=</span> <span class="n">f</span><span class="p">)</span>
                <span class="n">i1</span><span class="o">+=</span><span class="mi">1</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;ATOMT</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">  1        Xx  0.0100  76  76  76  76  76  76 204</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">  0 0 0 0 0 0</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">SCENE</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">-0.538344 -0.838391  0.085359  0.000000</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">-0.362057  0.138632 -0.921789  0.000000</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1"> 0.760986 -0.527145 -0.378177  0.000000</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1"> 0.000000  0.000000  0.000000  1.000000</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">  0.000    0.000</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">  0.000</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">  1.320</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">HBOND 0 2</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">STYLE</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">DISPF 37753794</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">MODEL    0  1  0</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">SURFS    0  1  1</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">SECTS  32  1</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">FORMS    0  1</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">ATOMS    0  0  1</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">BONDS    2</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">POLYS    1</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">VECTS 1.000000</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">FORMP</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">  1  1.0    0    0    0</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">ATOMP</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1"> 24  24    0  50  2.0    0</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">BONDP</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">  1  16  0.250  2.000 127 127 127</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">POLYP</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1"> 204 1  1.000 180 180 180</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">ISURF</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">  0    0    0    0</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">TEX3P</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">  1  0.00000E+00  1.00000E+00</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">SECTP</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">  1  5.00000E-01  5.00000E-01  0.00000E+00  0.00000E+00  0.00000E+00  0.00000E+00</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">CONTR</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1"> 0.1 -1 1 1 10 -1 2 5</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1"> 2 1 2 1</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">    0    0    0</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">    0    0    0</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">    0    0    0</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">    0    0    0</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">HKLPP</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1"> 192 1  1.000 255    0 255</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">UCOLP</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">    0    1  1.000    0    0    0</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">COMPS 0</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">LABEL 1     12  1.000 0</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">PROJT 0  0.962</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">BKGRC</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1"> 255 255 255</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">DPTHQ 1 -0.5000  3.5000</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">LIGHT0 1</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1"> 1.000000  0.000000  0.000000  0.000000</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1"> 0.000000  1.000000  0.000000  0.000000</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1"> 0.000000  0.000000  1.000000  0.000000</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1"> 0.000000  0.000000  0.000000  1.000000</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1"> 0.000000  0.000000 20.000000  0.000000</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1"> 0.000000  0.000000 -1.000000</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">  26  26  26 255</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1"> 179 179 179 255</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1"> 255 255 255 255</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">LIGHT1</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1"> 1.000000  0.000000  0.000000  0.000000</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1"> 0.000000  1.000000  0.000000  0.000000</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1"> 0.000000  0.000000  1.000000  0.000000</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1"> 0.000000  0.000000  0.000000  1.000000</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1"> 0.000000  0.000000 20.000000  0.000000</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1"> 0.000000  0.000000 -1.000000</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">    0    0    0    0</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">    0    0    0    0</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">    0    0    0    0</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">LIGHT2</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1"> 1.000000  0.000000  0.000000  0.000000</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1"> 0.000000  1.000000  0.000000  0.000000</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1"> 0.000000  0.000000  1.000000  0.000000</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1"> 0.000000  0.000000  0.000000  1.000000</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1"> 0.000000  0.000000 20.000000  0.000000</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1"> 0.000000  0.000000 -1.000000</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">    0    0    0    0</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">    0    0    0    0</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">    0    0    0    0</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">LIGHT3</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1"> 1.000000  0.000000  0.000000  0.000000</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1"> 0.000000  1.000000  0.000000  0.000000</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1"> 0.000000  0.000000  1.000000  0.000000</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1"> 0.000000  0.000000  0.000000  1.000000</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1"> 0.000000  0.000000 20.000000  0.000000</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1"> 0.000000  0.000000 -1.000000</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">    0    0    0    0</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">    0    0    0    0</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">    0    0    0    0</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">ATOMM</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1"> 204 204 204 255</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">  25.600</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">BONDM</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1"> 255 255 255 255</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1"> 128.000</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">POLYM</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1"> 255 255 255 255</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1"> 128.000</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">SURFM</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">    0    0    0 255</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1"> 128.000</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">FORMM</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1"> 255 255 255 255</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1"> 128.000</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">HKLPM</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1"> 255 255 255 255</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1"> 128.000&#39;</span><span class="p">,</span><span class="n">file</span> <span class="o">=</span> <span class="n">f</span><span class="p">)</span>
            <span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">verbose</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;    written in </span><span class="si">%s</span><span class="s1">&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">file_name</span><span class="p">))</span>
            <span class="k">return</span> <span class="mi">0</span>
    
    <span class="k">if</span> <span class="n">select</span> <span class="o">==</span> <span class="s1">&#39;podatm&#39;</span><span class="p">:</span>
        
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">obj</span><span class="o">==</span><span class="kc">None</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;no volume obj&#39;</span><span class="p">)</span>
            <span class="k">return</span> <span class="mi">0</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># get independent edges</span>
            <span class="n">edges</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">generator_obj_edge</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">verbose</span><span class="p">)</span>
            <span class="c1"># get independent vertices of the edges</span>
            <span class="n">vertices</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">remove_doubling_in_perp_space</span><span class="p">(</span><span class="n">edges</span><span class="p">)</span>
            <span class="c1"># get bond pairs, [[distance, XXX, YYY],...]</span>
            <span class="n">pairs</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">edge</span> <span class="ow">in</span> <span class="n">edges</span><span class="p">:</span>
                <span class="n">dist</span><span class="o">=</span><span class="n">intsct</span><span class="o">.</span><span class="n">distance_in_perp_space</span><span class="p">(</span><span class="n">edge</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">edge</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                <span class="n">a</span><span class="o">=</span><span class="p">[</span><span class="n">dist</span><span class="p">]</span>
                <span class="k">for</span> <span class="n">i2</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span>
                    <span class="n">i3</span><span class="o">=</span><span class="mi">0</span>
                    <span class="k">for</span> <span class="n">vrtx</span> <span class="ow">in</span> <span class="n">vertices</span><span class="p">:</span>
                        <span class="n">tmp</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="n">edge</span><span class="p">[</span><span class="n">i2</span><span class="p">],</span><span class="n">vrtx</span><span class="p">])</span>
                        <span class="n">tmp</span><span class="o">=</span><span class="n">utils</span><span class="o">.</span><span class="n">remove_doubling_in_perp_space</span><span class="p">(</span><span class="n">tmp</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
                        <span class="n">i3</span><span class="o">+=</span><span class="mi">1</span>
                        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">tmp</span><span class="p">)</span><span class="o">==</span><span class="mi">1</span><span class="p">:</span>
                            <span class="n">a</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i3</span><span class="p">)</span>
                            <span class="k">break</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="k">pass</span>
                <span class="n">pairs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
                
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;#VESTA_FORMAT_VERSION 3.5.0</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">f</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;MOLECULE</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">TITLE&#39;</span><span class="p">,</span><span class="n">file</span><span class="o">=</span><span class="n">f</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1">/</span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">path</span><span class="p">,</span><span class="n">basename</span><span class="p">),</span> <span class="n">file</span><span class="o">=</span><span class="n">f</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;GROUP</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">1 1 Custom</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">SYMOP</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1"> 0.000000  0.000000  0.000000  1  0  0    0  1  0    0  0  1    1</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1"> -1.0 -1.0 -1.0  0 0 0  0 0 0  0 0 0</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">TRANM 0</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1"> 0.000000  0.000000  0.000000  1  0  0    0  1  0    0  0  1</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">LTRANSL</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1"> -1</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1"> 0.000000  0.000000  0.000000  0.000000  0.000000  0.000000</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">LORIENT</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1"> -1    0    0    0    0</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1"> 1.000000  0.000000  0.000000  1.000000  0.000000  0.000000</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1"> 0.000000  0.000000  1.000000  0.000000  0.000000  1.000000</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">LMATRIX</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1"> 1.000000  0.000000  0.000000  0.000000</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1"> 0.000000  1.000000  0.000000  0.000000</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1"> 0.000000  0.000000  1.000000  0.000000</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1"> 0.000000  0.000000  0.000000  1.000000</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1"> 0.000000  0.000000  0.000000</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">CELLP</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">  1.000000    1.000000    1.000000  90.000000  90.000000  90.000000</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">  0.000000    0.000000    0.000000    0.000000    0.000000    0.000000</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">STRUC&#39;</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">f</span><span class="p">)</span>
            <span class="n">i2</span><span class="o">=</span><span class="mi">0</span>
            <span class="k">for</span> <span class="n">vrtx</span> <span class="ow">in</span> <span class="n">vertices</span><span class="p">:</span>
                <span class="n">xyz</span> <span class="o">=</span> <span class="n">math1</span><span class="o">.</span><span class="n">projection3</span><span class="p">(</span><span class="n">vrtx</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%4d</span><span class="s1"> A        A</span><span class="si">%d</span><span class="s1">  1.0000    </span><span class="si">%8.6f</span><span class="s1"> </span><span class="si">%8.6f</span><span class="s1"> </span><span class="si">%8.6f</span><span class="s1">        1&#39;</span><span class="o">%</span>\
                <span class="p">(</span><span class="n">i2</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">i2</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">numericalc</span><span class="o">.</span><span class="n">numeric_value</span><span class="p">(</span><span class="n">xyz</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span><span class="n">numericalc</span><span class="o">.</span><span class="n">numeric_value</span><span class="p">(</span><span class="n">xyz</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span><span class="n">numericalc</span><span class="o">.</span><span class="n">numeric_value</span><span class="p">(</span><span class="n">xyz</span><span class="p">[</span><span class="mi">2</span><span class="p">])),</span> <span class="n">file</span><span class="o">=</span><span class="n">f</span><span class="p">)</span>
                <span class="n">i2</span><span class="o">+=</span><span class="mi">1</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;                             0.000000    0.000000    0.000000  0.00&#39;</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">f</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;  0 0 0 0 0 0 0</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">THERI 0&#39;</span><span class="p">,</span> <span class="n">file</span> <span class="o">=</span> <span class="n">f</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">i2</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">vertices</span><span class="p">)):</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;  </span><span class="si">%d</span><span class="s1">        A</span><span class="si">%d</span><span class="s1">  1.000000&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">i2</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">i2</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span> <span class="n">file</span><span class="o">=</span><span class="n">f</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;  0 0 0</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">SHAPE</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">  0         0         0         0    0.000000  0    192    192    192    192</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">BOUND</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">         0          1        0          1        0          1</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">  0    0    0    0  0</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">SBOND&#39;</span><span class="p">,</span> <span class="n">file</span> <span class="o">=</span> <span class="n">f</span><span class="p">)</span>
            <span class="n">clr</span><span class="o">=</span><span class="n">colors</span><span class="p">(</span><span class="n">color</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">pair</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">pairs</span><span class="p">)):</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;  </span><span class="si">%d</span><span class="s1">   A</span><span class="si">%d</span><span class="s1">   A</span><span class="si">%d</span><span class="s1">   </span><span class="si">%6.3f</span><span class="s1">   </span><span class="si">%6.3f</span><span class="s1">  0  1  1  1  2  0.250  2.000 </span><span class="si">%3d</span><span class="s1"> </span><span class="si">%3d</span><span class="s1"> </span><span class="si">%3d</span><span class="s1">&#39;</span><span class="o">%</span><span class="p">(</span>\
                <span class="n">i2</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">pair</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">pair</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">pair</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">pair</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">clr</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">clr</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">clr</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span> <span class="n">file</span><span class="o">=</span><span class="n">f</span><span class="p">)</span>
                <span class="n">i2</span><span class="o">+=</span><span class="mi">1</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;  0 0 0 0</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">SITET&#39;</span><span class="p">,</span> <span class="n">file</span> <span class="o">=</span> <span class="n">f</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">i2</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">vertices</span><span class="p">)):</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;    </span><span class="si">%d</span><span class="s1">        A</span><span class="si">%d</span><span class="s1">  0.100  76  76  76  76  76  76 204  0&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">i2</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">i2</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span> <span class="n">file</span><span class="o">=</span><span class="n">f</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;  0 0 0 0 0 0</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">VECTR</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1"> 0 0 0 0 0</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">VECTT</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1"> 0 0 0 0 0</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">SPLAN</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">  0    0    0    0</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">LBLAT</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1"> -1</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">LBLSP</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1"> -1</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">DLATM</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1"> -1</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">DLBND</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1"> -1</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">DLPLY</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1"> -1</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">PLN2D</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">  0    0    0    0&#39;</span><span class="p">,</span> <span class="n">file</span> <span class="o">=</span> <span class="n">f</span><span class="p">)</span>
        
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;ATOMT</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">  1        A  0.0100  76  76  76  76  76  76 204</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">  0 0 0 0 0 0</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">SCENE</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">-0.538344 -0.838391  0.085359  0.000000</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">-0.362057  0.138632 -0.921789  0.000000</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1"> 0.760986 -0.527145 -0.378177  0.000000</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1"> 0.000000  0.000000  0.000000  1.000000</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">  0.000    0.000</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">  0.000</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">  1.320</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">HBOND 0 2</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">STYLE</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">DISPF 37753794</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">MODEL    0  1  0</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">SURFS    0  1  1</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">SECTS  32  1</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">FORMS    0  1</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">ATOMS    0  0  1</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">BONDS    2</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">POLYS    1</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">VECTS 1.000000</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">FORMP</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">  1  1.0    0    0    0</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">ATOMP</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1"> 24  24    0  50  2.0    0</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">BONDP</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">  1  16  0.250  2.000 127 127 127</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">POLYP</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1"> 204 1  1.000 180 180 180</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">ISURF</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">  0    0    0    0</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">TEX3P</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">  1  0.00000E+00  1.00000E+00</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">SECTP</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">  1  5.00000E-01  5.00000E-01  0.00000E+00  0.00000E+00  0.00000E+00  0.00000E+00</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">CONTR</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1"> 0.1 -1 1 1 10 -1 2 5</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1"> 2 1 2 1</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">    0    0    0</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">    0    0    0</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">    0    0    0</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">    0    0    0</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">HKLPP</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1"> 192 1  1.000 255    0 255</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">UCOLP</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">    0    1  1.000    0    0    0</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">COMPS 0</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">LABEL 1     12  1.000 0</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">PROJT 0  0.962</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">BKGRC</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1"> 255 255 255</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">DPTHQ 1 -0.5000  3.5000</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">LIGHT0 1</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1"> 1.000000  0.000000  0.000000  0.000000</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1"> 0.000000  1.000000  0.000000  0.000000</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1"> 0.000000  0.000000  1.000000  0.000000</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1"> 0.000000  0.000000  0.000000  1.000000</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1"> 0.000000  0.000000 20.000000  0.000000</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1"> 0.000000  0.000000 -1.000000</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">  26  26  26 255</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1"> 179 179 179 255</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1"> 255 255 255 255</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">LIGHT1</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1"> 1.000000  0.000000  0.000000  0.000000</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1"> 0.000000  1.000000  0.000000  0.000000</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1"> 0.000000  0.000000  1.000000  0.000000</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1"> 0.000000  0.000000  0.000000  1.000000</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1"> 0.000000  0.000000 20.000000  0.000000</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1"> 0.000000  0.000000 -1.000000</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">    0    0    0    0</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">    0    0    0    0</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">    0    0    0    0</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">LIGHT2</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1"> 1.000000  0.000000  0.000000  0.000000</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1"> 0.000000  1.000000  0.000000  0.000000</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1"> 0.000000  0.000000  1.000000  0.000000</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1"> 0.000000  0.000000  0.000000  1.000000</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1"> 0.000000  0.000000 20.000000  0.000000</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1"> 0.000000  0.000000 -1.000000</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">    0    0    0    0</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">    0    0    0    0</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">    0    0    0    0</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">LIGHT3</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1"> 1.000000  0.000000  0.000000  0.000000</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1"> 0.000000  1.000000  0.000000  0.000000</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1"> 0.000000  0.000000  1.000000  0.000000</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1"> 0.000000  0.000000  0.000000  1.000000</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1"> 0.000000  0.000000 20.000000  0.000000</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1"> 0.000000  0.000000 -1.000000</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">    0    0    0    0</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">    0    0    0    0</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">    0    0    0    0</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">ATOMM</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1"> 204 204 204 255</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">  25.600</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">BONDM</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1"> 255 255 255 255</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1"> 128.000</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">POLYM</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1"> 255 255 255 255</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1"> 128.000</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">SURFM</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">    0    0    0 255</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1"> 128.000</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">FORMM</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1"> 255 255 255 255</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1"> 128.000</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1">HKLPM</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1"> 255 255 255 255</span><span class="se">\</span>
<span class="s1">            </span><span class="se">\n</span><span class="s1"> 128.000&#39;</span><span class="p">,</span><span class="n">file</span> <span class="o">=</span> <span class="n">f</span><span class="p">)</span>
        
            <span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
            <span class="c1">#write_vesta_separate(obj, path, basename, color, dmax)</span>
            <span class="k">if</span> <span class="n">verbose</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;    written in </span><span class="si">%s</span><span class="s1">&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">file_name</span><span class="p">))</span>
            <span class="k">return</span> <span class="n">vertices</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">1</span></div>

    
<div class="viewcode-block" id="write_xyz">
<a class="viewcode-back" href="../../../pyqcstrc.ico2.html#pyqcstrc.ico2.occupation_domain.write_xyz">[docs]</a>
<span class="k">def</span> <span class="nf">write_xyz</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span><span class="n">path</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">,</span><span class="n">basename</span><span class="o">=</span><span class="s1">&#39;tmp&#39;</span><span class="p">,</span><span class="n">select</span><span class="o">=</span><span class="s1">&#39;tetrahedron&#39;</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Export occupation domains in XYZ format.</span>
<span class="sd">    </span>
<span class="sd">    Args:</span>
<span class="sd">        obj (numpy.ndarray): the occupation domain</span>
<span class="sd">            The shape is (num,4,6,3), where num=numbre_of_tetrahedron.</span>
<span class="sd">        path (str): Path of the output XYZ file</span>
<span class="sd">        basename (str): Basename of the output XYZ file</span>
<span class="sd">        select (str)</span>
<span class="sd">            &#39;tetrahedron&#39;: set of tetrahedra (default)</span>
<span class="sd">            &#39;triangle&#39;   : set of triangles</span>
<span class="sd">            &#39;edge&#39;       : set of edges</span>
<span class="sd">            &#39;vertex&#39;      : set of vertices</span>
<span class="sd">            (default, select = &#39;tetrahedron&#39;)</span>
<span class="sd">    </span>
<span class="sd">    Returns:</span>
<span class="sd">        int: 0 (succeed), 1 (fail)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="k">def</span> <span class="nf">generator_xyz_dim4_tetrahedron</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span><span class="n">filename</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Generate object (set of tetrahedra) object in XYZ format.</span>
<span class="sd">    </span>
<span class="sd">         Args:</span>
<span class="sd">            obj (numpy.ndarray): the occupation domain</span>
<span class="sd">                The shape is (num,4,6,3), where num=numbre_of_tetrahedron.</span>
<span class="sd">            filename (str): filename of the output XYZ file</span>
<span class="sd">        </span>
<span class="sd">        Returns:</span>
<span class="sd">            int: 0 (succeed), 1 (fail)</span>
<span class="sd">    </span>
<span class="sd">        &quot;&quot;&quot;</span>
            
        <span class="n">f</span><span class="o">=</span><span class="nb">open</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1">&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">filename</span><span class="p">),</span><span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%d</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">%</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span><span class="o">*</span><span class="mi">4</span><span class="p">))</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">filename</span><span class="p">))</span>
        <span class="n">i1</span><span class="o">=</span><span class="mi">0</span>
        <span class="k">for</span> <span class="n">tetrahedron</span> <span class="ow">in</span> <span class="n">obj</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">i2</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
                <span class="n">v</span><span class="o">=</span><span class="n">math1</span><span class="o">.</span><span class="n">projection3</span><span class="p">(</span><span class="n">tetrahedron</span><span class="p">[</span><span class="n">i2</span><span class="p">])</span>
                <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;Xx </span><span class="si">%8.6f</span><span class="s1"> </span><span class="si">%8.6f</span><span class="s1"> </span><span class="si">%8.6f</span><span class="s1"> # </span><span class="si">%3d</span><span class="s1">-the tetrahedron </span><span class="si">%d</span><span class="s1">-th vertex # </span><span class="si">%d</span><span class="s1"> </span><span class="si">%d</span><span class="s1"> </span><span class="si">%d</span><span class="s1"> </span><span class="si">%d</span><span class="s1"> </span><span class="si">%d</span><span class="s1"> </span><span class="si">%d</span><span class="s1"> </span><span class="si">%d</span><span class="s1"> </span><span class="si">%d</span><span class="s1"> </span><span class="si">%d</span><span class="s1"> </span><span class="si">%d</span><span class="s1"> </span><span class="si">%d</span><span class="s1"> </span><span class="si">%d</span><span class="s1"> </span><span class="si">%d</span><span class="s1"> </span><span class="si">%d</span><span class="s1"> </span><span class="si">%d</span><span class="s1"> </span><span class="si">%d</span><span class="s1"> </span><span class="si">%d</span><span class="s1"> </span><span class="si">%d</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">%</span>\
                <span class="p">(</span><span class="n">numericalc</span><span class="o">.</span><span class="n">numeric_value</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>\
                <span class="n">numericalc</span><span class="o">.</span><span class="n">numeric_value</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span>\
                <span class="n">numericalc</span><span class="o">.</span><span class="n">numeric_value</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span>\
                <span class="n">i1</span><span class="p">,</span><span class="n">i2</span><span class="p">,</span>\
                <span class="n">tetrahedron</span><span class="p">[</span><span class="n">i2</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="n">tetrahedron</span><span class="p">[</span><span class="n">i2</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span><span class="n">tetrahedron</span><span class="p">[</span><span class="n">i2</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">],</span>\
                <span class="n">tetrahedron</span><span class="p">[</span><span class="n">i2</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="n">tetrahedron</span><span class="p">[</span><span class="n">i2</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span><span class="n">tetrahedron</span><span class="p">[</span><span class="n">i2</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">],</span>\
                <span class="n">tetrahedron</span><span class="p">[</span><span class="n">i2</span><span class="p">][</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="n">tetrahedron</span><span class="p">[</span><span class="n">i2</span><span class="p">][</span><span class="mi">2</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span><span class="n">tetrahedron</span><span class="p">[</span><span class="n">i2</span><span class="p">][</span><span class="mi">2</span><span class="p">][</span><span class="mi">2</span><span class="p">],</span>\
                <span class="n">tetrahedron</span><span class="p">[</span><span class="n">i2</span><span class="p">][</span><span class="mi">3</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="n">tetrahedron</span><span class="p">[</span><span class="n">i2</span><span class="p">][</span><span class="mi">3</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span><span class="n">tetrahedron</span><span class="p">[</span><span class="n">i2</span><span class="p">][</span><span class="mi">3</span><span class="p">][</span><span class="mi">2</span><span class="p">],</span>\
                <span class="n">tetrahedron</span><span class="p">[</span><span class="n">i2</span><span class="p">][</span><span class="mi">4</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="n">tetrahedron</span><span class="p">[</span><span class="n">i2</span><span class="p">][</span><span class="mi">4</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span><span class="n">tetrahedron</span><span class="p">[</span><span class="n">i2</span><span class="p">][</span><span class="mi">4</span><span class="p">][</span><span class="mi">2</span><span class="p">],</span>\
                <span class="n">tetrahedron</span><span class="p">[</span><span class="n">i2</span><span class="p">][</span><span class="mi">5</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="n">tetrahedron</span><span class="p">[</span><span class="n">i2</span><span class="p">][</span><span class="mi">5</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span><span class="n">tetrahedron</span><span class="p">[</span><span class="n">i2</span><span class="p">][</span><span class="mi">5</span><span class="p">][</span><span class="mi">2</span><span class="p">]))</span>
            <span class="n">i1</span><span class="o">+=</span><span class="mi">1</span>
        <span class="n">vol</span><span class="o">=</span><span class="n">utils</span><span class="o">.</span><span class="n">obj_volume_6d</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;volume = </span><span class="si">%d</span><span class="s1"> </span><span class="si">%d</span><span class="s1"> </span><span class="si">%d</span><span class="s1"> (</span><span class="si">%8.6f</span><span class="s1">)</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">vol</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">vol</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">vol</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="n">numericalc</span><span class="o">.</span><span class="n">numeric_value</span><span class="p">(</span><span class="n">vol</span><span class="p">)))</span>
        <span class="k">for</span> <span class="n">i1</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">obj</span><span class="p">)):</span>
            <span class="n">v</span><span class="o">=</span><span class="n">utils</span><span class="o">.</span><span class="n">tetrahedron_volume_6d</span><span class="p">(</span><span class="n">tetrahedron</span><span class="p">)</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%3d</span><span class="s1">-the tetrahedron, </span><span class="si">%d</span><span class="s1"> </span><span class="si">%d</span><span class="s1"> </span><span class="si">%d</span><span class="s1"> (</span><span class="si">%8.6f</span><span class="s1">)</span><span class="se">\n</span><span class="s1">&#39;</span>\
                    <span class="o">%</span><span class="p">(</span><span class="n">i1</span><span class="p">,</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">v</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="n">numericalc</span><span class="o">.</span><span class="n">numeric_value</span><span class="p">(</span><span class="n">v</span><span class="p">)))</span>
        <span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="k">return</span> <span class="mi">0</span>
    
    <span class="k">def</span> <span class="nf">generator_xyz_dim4_triangle</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span><span class="n">filename</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Generate object (set of triangles) object in XYZ format.</span>
<span class="sd">    </span>
<span class="sd">        Args:</span>
<span class="sd">            obj (numpy.ndarray): the occupation domain</span>
<span class="sd">                The shape is (num,3,6,3), where num=numbre_of_triangle.</span>
<span class="sd">            filename (str): filename of the output XYZ file</span>
<span class="sd">        </span>
<span class="sd">        Returns:</span>
<span class="sd">            int: 0 (succeed), 1 (fail)</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">f</span><span class="o">=</span><span class="nb">open</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1">&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">filename</span><span class="p">),</span><span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%d</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">%</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span><span class="o">*</span><span class="mi">3</span><span class="p">))</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">filename</span><span class="p">))</span>
        <span class="n">i1</span><span class="o">=</span><span class="mi">0</span>
        <span class="k">for</span> <span class="n">triangle</span> <span class="ow">in</span> <span class="n">obj</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">i2</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
                <span class="n">v</span><span class="o">=</span><span class="n">math1</span><span class="o">.</span><span class="n">projection3</span><span class="p">(</span><span class="n">triangle</span><span class="p">[</span><span class="n">i2</span><span class="p">])</span>
                <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;Xx </span><span class="si">%8.6f</span><span class="s1"> </span><span class="si">%8.6f</span><span class="s1"> </span><span class="si">%8.6f</span><span class="s1"> # </span><span class="si">%3d</span><span class="s1">-the triangle </span><span class="si">%d</span><span class="s1">-th vertex # </span><span class="si">%d</span><span class="s1"> </span><span class="si">%d</span><span class="s1"> </span><span class="si">%d</span><span class="s1"> </span><span class="si">%d</span><span class="s1"> </span><span class="si">%d</span><span class="s1"> </span><span class="si">%d</span><span class="s1"> </span><span class="si">%d</span><span class="s1"> </span><span class="si">%d</span><span class="s1"> </span><span class="si">%d</span><span class="s1"> </span><span class="si">%d</span><span class="s1"> </span><span class="si">%d</span><span class="s1"> </span><span class="si">%d</span><span class="s1"> </span><span class="si">%d</span><span class="s1"> </span><span class="si">%d</span><span class="s1"> </span><span class="si">%d</span><span class="s1"> </span><span class="si">%d</span><span class="s1"> </span><span class="si">%d</span><span class="s1"> </span><span class="si">%d</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">%</span>\
                <span class="p">(</span><span class="n">numericalc</span><span class="o">.</span><span class="n">numeric_value</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>\
                <span class="n">numericalc</span><span class="o">.</span><span class="n">numeric_value</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span>\
                <span class="n">numericalc</span><span class="o">.</span><span class="n">numeric_value</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span>\
                <span class="n">i1</span><span class="p">,</span><span class="n">i2</span><span class="p">,</span>\
                <span class="n">triangle</span><span class="p">[</span><span class="n">i2</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="n">triangle</span><span class="p">[</span><span class="n">i2</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span><span class="n">triangle</span><span class="p">[</span><span class="n">i2</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">],</span>\
                <span class="n">triangle</span><span class="p">[</span><span class="n">i2</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="n">triangle</span><span class="p">[</span><span class="n">i2</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span><span class="n">triangle</span><span class="p">[</span><span class="n">i2</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">],</span>\
                <span class="n">triangle</span><span class="p">[</span><span class="n">i2</span><span class="p">][</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="n">triangle</span><span class="p">[</span><span class="n">i2</span><span class="p">][</span><span class="mi">2</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span><span class="n">triangle</span><span class="p">[</span><span class="n">i2</span><span class="p">][</span><span class="mi">2</span><span class="p">][</span><span class="mi">2</span><span class="p">],</span>\
                <span class="n">triangle</span><span class="p">[</span><span class="n">i2</span><span class="p">][</span><span class="mi">3</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="n">triangle</span><span class="p">[</span><span class="n">i2</span><span class="p">][</span><span class="mi">3</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span><span class="n">triangle</span><span class="p">[</span><span class="n">i2</span><span class="p">][</span><span class="mi">3</span><span class="p">][</span><span class="mi">2</span><span class="p">],</span>\
                <span class="n">triangle</span><span class="p">[</span><span class="n">i2</span><span class="p">][</span><span class="mi">4</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="n">triangle</span><span class="p">[</span><span class="n">i2</span><span class="p">][</span><span class="mi">4</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span><span class="n">triangle</span><span class="p">[</span><span class="n">i2</span><span class="p">][</span><span class="mi">4</span><span class="p">][</span><span class="mi">2</span><span class="p">],</span>\
                <span class="n">triangle</span><span class="p">[</span><span class="n">i2</span><span class="p">][</span><span class="mi">5</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="n">triangle</span><span class="p">[</span><span class="n">i2</span><span class="p">][</span><span class="mi">5</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span><span class="n">triangle</span><span class="p">[</span><span class="n">i2</span><span class="p">][</span><span class="mi">5</span><span class="p">][</span><span class="mi">2</span><span class="p">]))</span>
            <span class="n">i1</span><span class="o">+=</span><span class="mi">1</span>
        <span class="n">f</span><span class="o">.</span><span class="n">closed</span>
        <span class="k">return</span> <span class="mi">0</span>
    
    <span class="k">def</span> <span class="nf">generator_xyz_dim4_edge</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span><span class="n">filename</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Generate object (set of edges) object in XYZ format.</span>
<span class="sd">    </span>
<span class="sd">        Args:</span>
<span class="sd">            obj (numpy.ndarray): the occupation domain</span>
<span class="sd">                The shape is (num,2,6,3), where num=numbre_of_e.</span>
<span class="sd">            filename (str): filename of the output XYZ file</span>
<span class="sd">        </span>
<span class="sd">        Returns:</span>
<span class="sd">            int: 0 (succeed), 1 (fail)</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">f</span><span class="o">=</span><span class="nb">open</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1">&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">filename</span><span class="p">),</span><span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%d</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">%</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span><span class="o">*</span><span class="mi">2</span><span class="p">))</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">filename</span><span class="p">))</span>
        <span class="n">i1</span><span class="o">=</span><span class="mi">0</span>
        <span class="k">for</span> <span class="n">edge</span> <span class="ow">in</span> <span class="n">obj</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">i2</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span>
                <span class="n">v</span><span class="o">=</span><span class="n">math1</span><span class="o">.</span><span class="n">projection3</span><span class="p">(</span><span class="n">edge</span><span class="p">[</span><span class="n">i2</span><span class="p">])</span>
                <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;Xx </span><span class="si">%8.6f</span><span class="s1"> </span><span class="si">%8.6f</span><span class="s1"> </span><span class="si">%8.6f</span><span class="s1"> # </span><span class="si">%3d</span><span class="s1">-the edge </span><span class="si">%d</span><span class="s1">-th vertex # </span><span class="si">%d</span><span class="s1"> </span><span class="si">%d</span><span class="s1"> </span><span class="si">%d</span><span class="s1"> </span><span class="si">%d</span><span class="s1"> </span><span class="si">%d</span><span class="s1"> </span><span class="si">%d</span><span class="s1"> </span><span class="si">%d</span><span class="s1"> </span><span class="si">%d</span><span class="s1"> </span><span class="si">%d</span><span class="s1"> </span><span class="si">%d</span><span class="s1"> </span><span class="si">%d</span><span class="s1"> </span><span class="si">%d</span><span class="s1"> </span><span class="si">%d</span><span class="s1"> </span><span class="si">%d</span><span class="s1"> </span><span class="si">%d</span><span class="s1"> </span><span class="si">%d</span><span class="s1"> </span><span class="si">%d</span><span class="s1"> </span><span class="si">%d</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">%</span>\
                <span class="p">(</span><span class="n">numericalc</span><span class="o">.</span><span class="n">numeric_value</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>\
                <span class="n">numericalc</span><span class="o">.</span><span class="n">numeric_value</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span>\
                <span class="n">numericalc</span><span class="o">.</span><span class="n">numeric_value</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span>\
                <span class="n">i1</span><span class="p">,</span><span class="n">i2</span><span class="p">,</span>\
                <span class="n">edge</span><span class="p">[</span><span class="n">i2</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="n">edge</span><span class="p">[</span><span class="n">i2</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span><span class="n">edge</span><span class="p">[</span><span class="n">i2</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">],</span>\
                <span class="n">edge</span><span class="p">[</span><span class="n">i2</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="n">edge</span><span class="p">[</span><span class="n">i2</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span><span class="n">edge</span><span class="p">[</span><span class="n">i2</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">],</span>\
                <span class="n">edge</span><span class="p">[</span><span class="n">i2</span><span class="p">][</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="n">edge</span><span class="p">[</span><span class="n">i2</span><span class="p">][</span><span class="mi">2</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span><span class="n">edge</span><span class="p">[</span><span class="n">i2</span><span class="p">][</span><span class="mi">2</span><span class="p">][</span><span class="mi">2</span><span class="p">],</span>\
                <span class="n">edge</span><span class="p">[</span><span class="n">i2</span><span class="p">][</span><span class="mi">3</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="n">edge</span><span class="p">[</span><span class="n">i2</span><span class="p">][</span><span class="mi">3</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span><span class="n">edge</span><span class="p">[</span><span class="n">i2</span><span class="p">][</span><span class="mi">3</span><span class="p">][</span><span class="mi">2</span><span class="p">],</span>\
                <span class="n">edge</span><span class="p">[</span><span class="n">i2</span><span class="p">][</span><span class="mi">4</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="n">edge</span><span class="p">[</span><span class="n">i2</span><span class="p">][</span><span class="mi">4</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span><span class="n">edge</span><span class="p">[</span><span class="n">i2</span><span class="p">][</span><span class="mi">4</span><span class="p">][</span><span class="mi">2</span><span class="p">],</span>\
                <span class="n">edge</span><span class="p">[</span><span class="n">i2</span><span class="p">][</span><span class="mi">5</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="n">edge</span><span class="p">[</span><span class="n">i2</span><span class="p">][</span><span class="mi">5</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span><span class="n">edge</span><span class="p">[</span><span class="n">i2</span><span class="p">][</span><span class="mi">5</span><span class="p">][</span><span class="mi">2</span><span class="p">]))</span>
            <span class="n">i1</span><span class="o">+=</span><span class="mi">1</span>
        <span class="n">f</span><span class="o">.</span><span class="n">closed</span>
        <span class="k">return</span> <span class="mi">0</span>
    
    <span class="k">def</span> <span class="nf">generator_xyz_dim4_vertex</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">filename</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Generate object (set of vertexs) object in XYZ format.</span>
<span class="sd">    </span>
<span class="sd">        Args:</span>
<span class="sd">            obj (numpy.ndarray): the occupation domain</span>
<span class="sd">                The shape is (num,3,6,3), where num=numbre_of_tetrahedron.</span>
<span class="sd">            filename (str): filename of the output XYZ file</span>
<span class="sd">        </span>
<span class="sd">        Returns:</span>
<span class="sd">            int: 0 (succeed), 1 (fail)</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">f</span><span class="o">=</span><span class="nb">open</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1">&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">filename</span><span class="p">),</span><span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%d</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">%</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">obj</span><span class="p">)))</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">filename</span><span class="p">))</span>
        <span class="n">i1</span><span class="o">=</span><span class="mi">0</span>
        <span class="k">for</span> <span class="n">point</span> <span class="ow">in</span> <span class="n">obj</span><span class="p">:</span>
            <span class="n">v</span><span class="o">=</span><span class="n">math1</span><span class="o">.</span><span class="n">projection3</span><span class="p">(</span><span class="n">point</span><span class="p">)</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;Xx </span><span class="si">%8.6f</span><span class="s1"> </span><span class="si">%8.6f</span><span class="s1"> </span><span class="si">%8.6f</span><span class="s1"> # </span><span class="si">%d</span><span class="s1">-th vertex # # # </span><span class="si">%d</span><span class="s1"> </span><span class="si">%d</span><span class="s1"> </span><span class="si">%d</span><span class="s1"> </span><span class="si">%d</span><span class="s1"> </span><span class="si">%d</span><span class="s1"> </span><span class="si">%d</span><span class="s1"> </span><span class="si">%d</span><span class="s1"> </span><span class="si">%d</span><span class="s1"> </span><span class="si">%d</span><span class="s1"> </span><span class="si">%d</span><span class="s1"> </span><span class="si">%d</span><span class="s1"> </span><span class="si">%d</span><span class="s1"> </span><span class="si">%d</span><span class="s1"> </span><span class="si">%d</span><span class="s1"> </span><span class="si">%d</span><span class="s1"> </span><span class="si">%d</span><span class="s1"> </span><span class="si">%d</span><span class="s1"> </span><span class="si">%d</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">%</span>\
            <span class="p">(</span><span class="n">numericalc</span><span class="o">.</span><span class="n">numeric_value</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>\
            <span class="n">numericalc</span><span class="o">.</span><span class="n">numeric_value</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span>\
            <span class="n">numericalc</span><span class="o">.</span><span class="n">numeric_value</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span>\
            <span class="n">i1</span><span class="p">,</span>\
            <span class="n">point</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="n">point</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span><span class="n">point</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">],</span>\
            <span class="n">point</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="n">point</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span><span class="n">point</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">],</span>\
            <span class="n">point</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="n">point</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span><span class="n">point</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">2</span><span class="p">],</span>\
            <span class="n">point</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="n">point</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span><span class="n">point</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="mi">2</span><span class="p">],</span>\
            <span class="n">point</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="n">point</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span><span class="n">point</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">2</span><span class="p">],</span>\
            <span class="n">point</span><span class="p">[</span><span class="mi">5</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="n">point</span><span class="p">[</span><span class="mi">5</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span><span class="n">point</span><span class="p">[</span><span class="mi">5</span><span class="p">][</span><span class="mi">2</span><span class="p">]))</span>
            <span class="n">i1</span><span class="o">=</span><span class="mi">0</span>
        <span class="n">f</span><span class="o">.</span><span class="n">closed</span>
        <span class="k">return</span> <span class="mi">0</span>
    
    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">obj</span><span class="o">==</span><span class="kc">None</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;empty obj&#39;</span><span class="p">)</span>
        <span class="k">return</span> 
    <span class="k">elif</span> <span class="n">obj</span><span class="o">.</span><span class="n">ndim</span><span class="o">!=</span><span class="mi">4</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;object has an incorrect shape!&#39;</span><span class="p">)</span>
        <span class="k">return</span> 
    <span class="k">else</span><span class="p">:</span>
        <span class="n">file_name</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1">/</span><span class="si">%s</span><span class="s1">.xyz&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">path</span><span class="p">,</span><span class="n">basename</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">select</span> <span class="o">==</span> <span class="s1">&#39;tetrahedron&#39;</span><span class="p">:</span>
            <span class="n">generator_xyz_dim4_tetrahedron</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">file_name</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">verbose</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;    written in </span><span class="si">%s</span><span class="s1">/</span><span class="si">%s</span><span class="s1">.xyz&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">path</span><span class="p">,</span><span class="n">basename</span><span class="p">))</span>
            <span class="k">return</span> <span class="mi">0</span>
        <span class="k">elif</span> <span class="n">select</span> <span class="o">==</span> <span class="s1">&#39;triangle&#39;</span><span class="p">:</span>
            <span class="n">generator_xyz_dim4_triangle</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">file_name</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">verbose</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;    written in </span><span class="si">%s</span><span class="s1">/</span><span class="si">%s</span><span class="s1">.xyz&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">path</span><span class="p">,</span><span class="n">basename</span><span class="p">))</span>
            <span class="k">return</span> <span class="mi">0</span>
        <span class="k">elif</span> <span class="n">select</span> <span class="o">==</span> <span class="s1">&#39;edge&#39;</span><span class="p">:</span>
            <span class="n">generator_xyz_dim4_edge</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">file_name</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">verbose</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;    written in </span><span class="si">%s</span><span class="s1">/</span><span class="si">%s</span><span class="s1">.xyz&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">path</span><span class="p">,</span><span class="n">basename</span><span class="p">))</span>
            <span class="k">return</span> <span class="mi">0</span>
        <span class="k">elif</span> <span class="n">select</span> <span class="o">==</span> <span class="s1">&#39;vertex&#39;</span><span class="p">:</span>
            <span class="n">generator_xyz_dim4_vertex</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">file_name</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">verbose</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;    written in </span><span class="si">%s</span><span class="s1">/</span><span class="si">%s</span><span class="s1">.xyz&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">path</span><span class="p">,</span><span class="n">basename</span><span class="p">))</span>
            <span class="k">return</span> <span class="mi">0</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">verbose</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;    error&#39;</span><span class="p">)</span>
            <span class="k">return</span> </div>


<div class="viewcode-block" id="read_xyz">
<a class="viewcode-back" href="../../../pyqcstrc.ico2.html#pyqcstrc.ico2.occupation_domain.read_xyz">[docs]</a>
<span class="k">def</span> <span class="nf">read_xyz</span><span class="p">(</span><span class="n">path</span><span class="p">,</span><span class="n">basename</span><span class="p">,</span><span class="n">select</span><span class="o">=</span><span class="s1">&#39;tetrahedron&#39;</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Load new occupation domain on input XYZ file.</span>
<span class="sd">    </span>
<span class="sd">    Args:</span>
<span class="sd">        path (str): Path of the input XYZ file</span>
<span class="sd">        basename (str): Basename of the input XYZ file</span>
<span class="sd">        select (str)</span>
<span class="sd">            &#39;tetrahedron&#39;: set of tetrahedra (default)</span>
<span class="sd">            &#39;vertex&#39;      : set of vertices</span>
<span class="sd">            (default, select = &#39;tetrahedron&#39;)</span>
<span class="sd">        verbose (int): verbose option</span>
<span class="sd">    Returns:</span>
<span class="sd">        Occupation domains (numpy.ndarray):</span>
<span class="sd">            Loaded occupation domains.</span>
<span class="sd">            The shape is (num,4,6,3), where num=numbre_of_tetrahedra (select = &#39;tetrahedron&#39;).</span>
<span class="sd">            The shape is (num,6,3), where num=numbre_of_vertices (select = &#39;vertex&#39;).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="k">def</span> <span class="nf">read_file</span><span class="p">(</span><span class="n">file</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">f</span><span class="o">=</span><span class="nb">open</span><span class="p">(</span><span class="n">file</span><span class="p">,</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">IOError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">line</span><span class="o">=</span><span class="p">[]</span>
        <span class="k">while</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">a</span><span class="o">=</span><span class="n">f</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">a</span><span class="p">:</span>
                <span class="k">break</span>
            <span class="n">line</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">a</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">line</span>
    
    <span class="n">filename</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1">/</span><span class="si">%s</span><span class="s1">.xyz&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">path</span><span class="p">,</span><span class="n">basename</span><span class="p">)</span>
    
    <span class="n">f1</span><span class="o">=</span><span class="n">read_file</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
    <span class="n">f0</span><span class="o">=</span><span class="n">f1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
    <span class="n">num</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">f0</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">num</span><span class="o">+</span><span class="mi">2</span><span class="p">):</span>
        <span class="n">fi</span><span class="o">=</span><span class="n">f1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="n">fi</span><span class="o">=</span><span class="n">fi</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
        <span class="n">a1</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">fi</span><span class="p">[</span><span class="mi">10</span><span class="p">])</span>
        <span class="n">b1</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">fi</span><span class="p">[</span><span class="mi">11</span><span class="p">])</span>
        <span class="n">c1</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">fi</span><span class="p">[</span><span class="mi">12</span><span class="p">])</span>
        <span class="n">a2</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">fi</span><span class="p">[</span><span class="mi">13</span><span class="p">])</span>
        <span class="n">b2</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">fi</span><span class="p">[</span><span class="mi">14</span><span class="p">])</span>
        <span class="n">c2</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">fi</span><span class="p">[</span><span class="mi">15</span><span class="p">])</span>
        <span class="n">a3</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">fi</span><span class="p">[</span><span class="mi">16</span><span class="p">])</span>
        <span class="n">b3</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">fi</span><span class="p">[</span><span class="mi">17</span><span class="p">])</span>
        <span class="n">c3</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">fi</span><span class="p">[</span><span class="mi">18</span><span class="p">])</span>
        <span class="n">a4</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">fi</span><span class="p">[</span><span class="mi">19</span><span class="p">])</span>
        <span class="n">b4</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">fi</span><span class="p">[</span><span class="mi">20</span><span class="p">])</span>
        <span class="n">c4</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">fi</span><span class="p">[</span><span class="mi">21</span><span class="p">])</span>
        <span class="n">a5</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">fi</span><span class="p">[</span><span class="mi">22</span><span class="p">])</span>
        <span class="n">b5</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">fi</span><span class="p">[</span><span class="mi">23</span><span class="p">])</span>
        <span class="n">c5</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">fi</span><span class="p">[</span><span class="mi">24</span><span class="p">])</span>
        <span class="n">a6</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">fi</span><span class="p">[</span><span class="mi">25</span><span class="p">])</span>
        <span class="n">b6</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">fi</span><span class="p">[</span><span class="mi">26</span><span class="p">])</span>
        <span class="n">c6</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">fi</span><span class="p">[</span><span class="mi">27</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">i</span><span class="o">==</span><span class="mi">2</span><span class="p">:</span>
            <span class="n">tmp</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">a1</span><span class="p">,</span><span class="n">b1</span><span class="p">,</span><span class="n">c1</span><span class="p">,</span><span class="n">a2</span><span class="p">,</span><span class="n">b2</span><span class="p">,</span><span class="n">c2</span><span class="p">,</span><span class="n">a3</span><span class="p">,</span><span class="n">b3</span><span class="p">,</span><span class="n">c3</span><span class="p">,</span><span class="n">a4</span><span class="p">,</span><span class="n">b4</span><span class="p">,</span><span class="n">c4</span><span class="p">,</span><span class="n">a5</span><span class="p">,</span><span class="n">b5</span><span class="p">,</span><span class="n">c5</span><span class="p">,</span><span class="n">a6</span><span class="p">,</span><span class="n">b6</span><span class="p">,</span><span class="n">c6</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">tmp</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tmp</span><span class="p">,[</span><span class="n">a1</span><span class="p">,</span><span class="n">b1</span><span class="p">,</span><span class="n">c1</span><span class="p">,</span><span class="n">a2</span><span class="p">,</span><span class="n">b2</span><span class="p">,</span><span class="n">c2</span><span class="p">,</span><span class="n">a3</span><span class="p">,</span><span class="n">b3</span><span class="p">,</span><span class="n">c3</span><span class="p">,</span><span class="n">a4</span><span class="p">,</span><span class="n">b4</span><span class="p">,</span><span class="n">c4</span><span class="p">,</span><span class="n">a5</span><span class="p">,</span><span class="n">b5</span><span class="p">,</span><span class="n">c5</span><span class="p">,</span><span class="n">a6</span><span class="p">,</span><span class="n">b6</span><span class="p">,</span><span class="n">c6</span><span class="p">])</span>
    <span class="k">if</span> <span class="n">verbose</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;    read </span><span class="si">%s</span><span class="s1">/</span><span class="si">%s</span><span class="s1">.xyz&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">path</span><span class="p">,</span><span class="n">basename</span><span class="p">))</span>
    
    <span class="k">if</span> <span class="n">select</span> <span class="o">==</span> <span class="s1">&#39;tetrahedron&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">tmp</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">num</span><span class="o">/</span><span class="mi">4</span><span class="p">),</span><span class="mi">4</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">select</span> <span class="o">==</span> <span class="s1">&#39;vertex&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">tmp</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">num</span><span class="p">),</span><span class="mi">6</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span></div>


<div class="viewcode-block" id="simplification">
<a class="viewcode-back" href="../../../pyqcstrc.ico2.html#pyqcstrc.ico2.occupation_domain.simplification">[docs]</a>
<span class="k">def</span> <span class="nf">simplification</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Simplification of occupation domains.</span>
<span class="sd">    </span>
<span class="sd">    Args:</span>
<span class="sd">        obj (numpy.ndarray): the occupation domain</span>
<span class="sd">            The shape is (num,4,6,3), where num=numbre_of_tetrahedron.</span>
<span class="sd">        num_cycle (int): numbre of cycles</span>
<span class="sd">        verbose (int)</span>
<span class="sd">            verbose = 0 (silent, default)</span>
<span class="sd">            verbose = 1 (normal)</span>
<span class="sd">            verbose &gt; 2 (detail)</span>
<span class="sd">    </span>
<span class="sd">    Returns:</span>
<span class="sd">    </span>
<span class="sd">        Simplified occupation domains (numpy.ndarray)</span>
<span class="sd">            The shape is (num,4,6,3), where num=numbre_of_tetrahedron.</span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">obj</span><span class="o">==</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">verbose</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;    zero volume&#39;</span><span class="p">)</span>
        <span class="k">return</span> 
    <span class="k">else</span><span class="p">:</span>
        <span class="n">vol0</span><span class="o">=</span><span class="n">utils</span><span class="o">.</span><span class="n">obj_volume_6d</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
        <span class="n">obj_convex_hull</span><span class="o">=</span><span class="n">utils</span><span class="o">.</span><span class="n">generate_convex_hull</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
        <span class="n">obj_tmp</span><span class="o">=</span><span class="n">intsct</span><span class="o">.</span><span class="n">intersection_two_obj_1</span><span class="p">(</span><span class="n">obj_convex_hull</span><span class="p">,</span><span class="n">obj</span><span class="p">)</span>
        <span class="n">vol1</span><span class="o">=</span><span class="n">utils</span><span class="o">.</span><span class="n">obj_volume_6d</span><span class="p">(</span><span class="n">obj_tmp</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">vol0</span><span class="o">==</span><span class="n">vol1</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">verbose</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;      simplification succeed:&#39;</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;      num of tetrahedra: </span><span class="si">%d</span><span class="s1"> --&gt; </span><span class="si">%d</span><span class="s1">&#39;</span><span class="o">%</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">obj</span><span class="p">),</span><span class="nb">len</span><span class="p">(</span><span class="n">obj_convex_hull</span><span class="p">)))</span>
            <span class="k">return</span> <span class="n">obj_convex_hull</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">verbose</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;      simplification: fail&#39;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">obj</span></div>


<div class="viewcode-block" id="generate_border_edges">
<a class="viewcode-back" href="../../../pyqcstrc.ico2.html#pyqcstrc.ico2.occupation_domain.generate_border_edges">[docs]</a>
<span class="k">def</span> <span class="nf">generate_border_edges</span><span class="p">(</span><span class="n">obj</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Generate border edges of the occupation domain.</span>
<span class="sd">    </span>
<span class="sd">    Args:</span>
<span class="sd">        obj (numpy.ndarray):</span>
<span class="sd">            The occupation domain</span>
<span class="sd">            The shape is (num,4,6,3), where num=numbre_of_tetrahedron.</span>
<span class="sd">    </span>
<span class="sd">    Returns:</span>
<span class="sd">        Border edges of the occupation domains (numpy.ndarray):</span>
<span class="sd">            The shape is (num,2,6,3), where num=numbre_of_edge.</span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">triangle_surface</span><span class="o">=</span><span class="n">utils</span><span class="o">.</span><span class="n">generator_surface_1</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">utils</span><span class="o">.</span><span class="n">surface_cleaner</span><span class="p">(</span><span class="n">triangle_surface</span><span class="p">)</span></div>


<span class="c1">#########################</span>
<span class="c1">#          WIP          #</span>
<span class="c1">#########################</span>
<div class="viewcode-block" id="simple_hand_step1">
<a class="viewcode-back" href="../../../pyqcstrc.ico2.html#pyqcstrc.ico2.occupation_domain.simple_hand_step1">[docs]</a>
<span class="k">def</span> <span class="nf">simple_hand_step1</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">basename_tmp</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Simplification of occupation domains by hand (step1).</span>
<span class="sd">    </span>
<span class="sd">    Args:</span>
<span class="sd">        obj (numpy.ndarray): the occupation domain</span>
<span class="sd">            The shape is (num,4,6,3), where num=numbre_of_tetrahedron.</span>
<span class="sd">        path (str): path of the tmporal file</span>
<span class="sd">        basename_tmp (str): name for tmporal file.</span>
<span class="sd">    </span>
<span class="sd">    Returns:</span>
<span class="sd">    </span>
<span class="sd">        Tmporal occupation domains (numpy.ndarray):</span>
<span class="sd">            The shape is (num,4,6,3), where num=numbre_of_tetrahedron.</span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">write_xyz_smpl</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">basename</span><span class="p">):</span>
        <span class="n">f</span><span class="o">=</span><span class="nb">open</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1">&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">path</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;/</span><span class="si">%s</span><span class="s1">.xyz&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">basename</span><span class="p">),</span><span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%d</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">%</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">a</span><span class="p">)))</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">basename</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">i1</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">a</span><span class="p">)):</span>
            <span class="n">xyz</span><span class="o">=</span><span class="n">math1</span><span class="o">.</span><span class="n">projection3</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="n">i1</span><span class="p">])</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;Xx </span><span class="si">%8.6f</span><span class="s1"> </span><span class="si">%8.6f</span><span class="s1"> </span><span class="si">%8.6f</span><span class="s1"> # </span><span class="si">%d</span><span class="s1">-th vertex # </span><span class="si">%d</span><span class="s1"> </span><span class="si">%d</span><span class="s1"> </span><span class="si">%d</span><span class="s1"> </span><span class="si">%d</span><span class="s1"> </span><span class="si">%d</span><span class="s1"> </span><span class="si">%d</span><span class="s1"> </span><span class="si">%d</span><span class="s1"> </span><span class="si">%d</span><span class="s1"> </span><span class="si">%d</span><span class="s1"> </span><span class="si">%d</span><span class="s1"> </span><span class="si">%d</span><span class="s1"> </span><span class="si">%d</span><span class="s1"> </span><span class="si">%d</span><span class="s1"> </span><span class="si">%d</span><span class="s1"> </span><span class="si">%d</span><span class="s1"> </span><span class="si">%d</span><span class="s1"> </span><span class="si">%d</span><span class="s1"> </span><span class="si">%d</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">%</span>\
            <span class="p">(</span><span class="n">numericalc</span><span class="o">.</span><span class="n">numeric_value</span><span class="p">(</span><span class="n">xyz</span><span class="p">),</span>\
            <span class="n">numericalc</span><span class="o">.</span><span class="n">numeric_value</span><span class="p">(</span><span class="n">xyz</span><span class="p">),</span>\
            <span class="n">numericalc</span><span class="o">.</span><span class="n">numeric_value</span><span class="p">(</span><span class="n">xyz</span><span class="p">),</span>\
            <span class="n">i1</span><span class="p">,</span>\
            <span class="n">a</span><span class="p">[</span><span class="n">i1</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="n">a</span><span class="p">[</span><span class="n">i1</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span><span class="n">a</span><span class="p">[</span><span class="n">i1</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">],</span>\
            <span class="n">a</span><span class="p">[</span><span class="n">i1</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="n">a</span><span class="p">[</span><span class="n">i1</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span><span class="n">a</span><span class="p">[</span><span class="n">i1</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">],</span>\
            <span class="n">a</span><span class="p">[</span><span class="n">i1</span><span class="p">][</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="n">a</span><span class="p">[</span><span class="n">i1</span><span class="p">][</span><span class="mi">2</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span><span class="n">a</span><span class="p">[</span><span class="n">i1</span><span class="p">][</span><span class="mi">2</span><span class="p">][</span><span class="mi">2</span><span class="p">],</span>\
            <span class="n">a</span><span class="p">[</span><span class="n">i1</span><span class="p">][</span><span class="mi">3</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="n">a</span><span class="p">[</span><span class="n">i1</span><span class="p">][</span><span class="mi">3</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span><span class="n">a</span><span class="p">[</span><span class="n">i1</span><span class="p">][</span><span class="mi">3</span><span class="p">][</span><span class="mi">2</span><span class="p">],</span>\
            <span class="n">a</span><span class="p">[</span><span class="n">i1</span><span class="p">][</span><span class="mi">4</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="n">a</span><span class="p">[</span><span class="n">i1</span><span class="p">][</span><span class="mi">4</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span><span class="n">a</span><span class="p">[</span><span class="n">i1</span><span class="p">][</span><span class="mi">4</span><span class="p">][</span><span class="mi">2</span><span class="p">],</span>\
            <span class="n">a</span><span class="p">[</span><span class="n">i1</span><span class="p">][</span><span class="mi">5</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="n">a</span><span class="p">[</span><span class="n">i1</span><span class="p">][</span><span class="mi">5</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span><span class="n">a</span><span class="p">[</span><span class="n">i1</span><span class="p">][</span><span class="mi">5</span><span class="p">][</span><span class="mi">2</span><span class="p">]))</span>
        <span class="n">f</span><span class="o">.</span><span class="n">closed</span>
        <span class="k">return</span> <span class="mi">0</span>
        
    <span class="n">od1a</span><span class="o">=</span><span class="n">utils</span><span class="o">.</span><span class="n">remove_doubling_in_perp_space</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
    <span class="n">write_xyz_smpl</span><span class="p">(</span><span class="n">od1a</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">basename_tmp</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;written in </span><span class="si">%s</span><span class="s1">&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">path</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;/</span><span class="si">%s</span><span class="s1">.xyz&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">basename_tmp</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;open above XYZ file in vesta and make merge_list, and run simple_hand_step2()&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">od1a</span></div>


<div class="viewcode-block" id="simple_hand_step2">
<a class="viewcode-back" href="../../../pyqcstrc.ico2.html#pyqcstrc.ico2.occupation_domain.simple_hand_step2">[docs]</a>
<span class="k">def</span> <span class="nf">simple_hand_step2</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">merge_list</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Simplification of occupation domains by hand (step2).</span>
<span class="sd">    </span>
<span class="sd">    Args:</span>
<span class="sd">        obj (numpy.ndarray): the occupation domain</span>
<span class="sd">            The shape is (num,4,6,3), where num=numbre_of_tetrahedron.</span>
<span class="sd">        merge_list (list[[int,int,int,int,],[],...,[]])</span>
<span class="sd">            A list containing lists of indices of vertices of tetrahedron.</span>
<span class="sd">            The indices of vertices of tetrahedron in temporal file obtaind</span>
<span class="sd">            by &#39;simple_hand_step1()&#39;.</span>
<span class="sd">    </span>
<span class="sd">    Returns:</span>
<span class="sd">        Simplified occupation domains (numpy.ndarray):</span>
<span class="sd">            The shape is (num,4,6,3), where num=numbre_of_tetrahedron.</span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="k">def</span> <span class="nf">merge</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span><span class="n">mylist</span><span class="p">):</span>
        <span class="n">tmp1</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">obj</span><span class="p">[</span><span class="n">mylist</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span><span class="p">]])</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">mylist</span><span class="p">)):</span>
            <span class="n">tmp2</span><span class="o">=</span><span class="n">obj</span><span class="p">[</span><span class="n">mylist</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">tmp1</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tmp1</span><span class="p">,</span><span class="n">tmp2</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">tmp1</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">mylist</span><span class="p">),</span><span class="mi">6</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
    
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">merge_list</span><span class="p">)):</span>
        <span class="n">tmp1</span><span class="o">=</span><span class="n">merge</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span><span class="n">merge_list</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
        <span class="n">od2</span><span class="o">=</span><span class="n">intsct</span><span class="o">.</span><span class="n">tetrahedralization_points</span><span class="p">(</span><span class="n">tmp1</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">i</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">od1</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">od2</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">od1</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="n">od1</span><span class="p">,</span><span class="n">od2</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">od1</span></div>


<div class="viewcode-block" id="site_symmetry">
<a class="viewcode-back" href="../../../pyqcstrc.ico2.html#pyqcstrc.ico2.occupation_domain.site_symmetry">[docs]</a>
<span class="k">def</span> <span class="nf">site_symmetry</span><span class="p">(</span><span class="n">wyckoff_position</span><span class="p">,</span> <span class="n">centering</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Symmetry operators in the site symmetry group G and its left coset decomposition.</span>
<span class="sd">    </span>
<span class="sd">    Args:</span>
<span class="sd">        Wyckoff position (numpy.ndarray):</span>
<span class="sd">            6D coordinate.</span>
<span class="sd">            The shape is (6,3).</span>
<span class="sd">        centering:</span>
<span class="sd">            primitive lattice (&#39;p&#39;)</span>
<span class="sd">            face-centered lattice (&#39;f&#39;) and </span>
<span class="sd">            body-centered lattice (&#39;i&#39;)</span>
<span class="sd">        verbose (int)</span>
<span class="sd">    </span>
<span class="sd">    Returns:</span>
<span class="sd">        List of index of symmetry operators of the site symmetry group G (list):</span>
<span class="sd">            The symmetry operators leaves xyz identical.</span>
<span class="sd">        </span>
<span class="sd">        List of index of symmetry operators in the left coset representatives of the poibt group G (list):</span>
<span class="sd">            The symmetry operators generates equivalent positions of the site xyz.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">translation</span><span class="p">():</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        translational symmetry</span>
<span class="sd">        primitive type lattice is assumed</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="c1"># under development</span>
        <span class="k">if</span> <span class="n">centering</span><span class="o">==</span><span class="s1">&#39;i&#39;</span><span class="p">:</span>
            <span class="n">cop</span> <span class="o">=</span> <span class="n">symmetry</span><span class="o">.</span><span class="n">generator_equivalent_vec</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">]]))</span>
        <span class="k">elif</span> <span class="n">centering</span><span class="o">==</span><span class="s1">&#39;f&#39;</span><span class="p">:</span>
            <span class="n">cop</span> <span class="o">=</span> <span class="n">symmetry</span><span class="o">.</span><span class="n">generator_equivalent_vec</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]]))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="n">symop</span><span class="o">=</span><span class="p">[]</span>
        <span class="n">tmp</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">symop</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tmp</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i1</span> <span class="ow">in</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]:</span>
            <span class="k">for</span> <span class="n">i2</span> <span class="ow">in</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]:</span>
                <span class="k">for</span> <span class="n">i3</span> <span class="ow">in</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]:</span>
                    <span class="k">for</span> <span class="n">i4</span> <span class="ow">in</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]:</span>
                        <span class="k">for</span> <span class="n">i5</span> <span class="ow">in</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]:</span>
                            <span class="k">for</span> <span class="n">i6</span> <span class="ow">in</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]:</span>
                                <span class="n">tmp</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">i1</span><span class="p">,</span><span class="n">i2</span><span class="p">,</span><span class="n">i3</span><span class="p">,</span><span class="n">i4</span><span class="p">,</span><span class="n">i5</span><span class="p">,</span><span class="n">i6</span><span class="p">])</span>
                                <span class="n">symop</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tmp</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">symop</span>
    
    <span class="k">def</span> <span class="nf">remove_overlaps_in_a_list</span><span class="p">(</span><span class="n">l1</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Remove overlap elements in list with set method.</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            l1 (list):</span>
<span class="sd">        </span>
<span class="sd">        Returns:</span>
<span class="sd">            l2 (list)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">tmp</span><span class="o">=</span><span class="nb">set</span><span class="p">(</span><span class="n">l1</span><span class="p">)</span>
        <span class="n">l2</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">tmp</span><span class="p">)</span>
        <span class="n">l2</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">l2</span>
    
    <span class="k">def</span> <span class="nf">find_overlaps</span><span class="p">(</span><span class="n">l1</span><span class="p">,</span><span class="n">l2</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        find overlap or not btween list1 and list2.</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            l1 (list):</span>
<span class="sd">            l2 (list):</span>
<span class="sd">        </span>
<span class="sd">        Returns:</span>
<span class="sd">            0 (int): no intersection</span>
<span class="sd">            1 (int): intersection</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">l3</span><span class="o">=</span><span class="n">remove_overlaps_in_a_list</span><span class="p">(</span><span class="n">l1</span><span class="o">+</span><span class="n">l2</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">l1</span><span class="p">)</span><span class="o">+</span><span class="nb">len</span><span class="p">(</span><span class="n">l2</span><span class="p">)</span><span class="o">==</span><span class="nb">len</span><span class="p">(</span><span class="n">l3</span><span class="p">):</span> <span class="c1"># no overlap</span>
            <span class="k">return</span> <span class="mi">0</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">1</span>
    
    <span class="n">symop</span><span class="o">=</span><span class="n">symmetry</span><span class="o">.</span><span class="n">icosasymop</span><span class="p">()</span>
    <span class="n">traop</span><span class="o">=</span><span class="n">translation</span><span class="p">()</span>
    
     <span class="c1"># List of index of symmetry operators of the site symmetry group G.</span>
     <span class="c1"># The symmetry operators leaves xyz identical.</span>
    <span class="n">list1</span><span class="o">=</span><span class="p">[]</span>
    
    <span class="c1"># List of index of symmetry operators which are not in the G.</span>
    <span class="n">list2</span><span class="o">=</span><span class="p">[]</span>
    
    <span class="n">pos</span><span class="o">=</span><span class="n">wyckoff_position</span>
    <span class="n">a1</span><span class="o">=</span><span class="p">(</span><span class="n">pos</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">TAU</span><span class="o">*</span><span class="n">pos</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="n">pos</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
    <span class="n">a2</span><span class="o">=</span><span class="p">(</span><span class="n">pos</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">TAU</span><span class="o">*</span><span class="n">pos</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="n">pos</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
    <span class="n">a3</span><span class="o">=</span><span class="p">(</span><span class="n">pos</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">TAU</span><span class="o">*</span><span class="n">pos</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="n">pos</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
    <span class="n">a4</span><span class="o">=</span><span class="p">(</span><span class="n">pos</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">TAU</span><span class="o">*</span><span class="n">pos</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="n">pos</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
    <span class="n">a5</span><span class="o">=</span><span class="p">(</span><span class="n">pos</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">TAU</span><span class="o">*</span><span class="n">pos</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="n">pos</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
    <span class="n">a6</span><span class="o">=</span><span class="p">(</span><span class="n">pos</span><span class="p">[</span><span class="mi">5</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">TAU</span><span class="o">*</span><span class="n">pos</span><span class="p">[</span><span class="mi">5</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="n">pos</span><span class="p">[</span><span class="mi">5</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
    <span class="n">xyz</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">a1</span><span class="p">,</span><span class="n">a2</span><span class="p">,</span><span class="n">a3</span><span class="p">,</span><span class="n">a4</span><span class="p">,</span><span class="n">a5</span><span class="p">,</span><span class="n">a6</span><span class="p">])</span>
    
    <span class="n">xyzi</span><span class="o">=</span><span class="n">numericalc</span><span class="o">.</span><span class="n">projection_numerical</span><span class="p">(</span><span class="n">xyz</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">xyz</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">xyz</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="n">xyz</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span><span class="n">xyz</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span><span class="n">xyz</span><span class="p">[</span><span class="mi">5</span><span class="p">])</span>
    <span class="n">xi</span><span class="o">=</span><span class="n">xyzi</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
    <span class="n">yi</span><span class="o">=</span><span class="n">xyzi</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>
    <span class="n">zi</span><span class="o">=</span><span class="n">xyzi</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">verbose</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39; site coordinates: </span><span class="si">%3.2f</span><span class="s1"> </span><span class="si">%3.2f</span><span class="s1"> </span><span class="si">%3.2f</span><span class="s1"> </span><span class="si">%3.2f</span><span class="s1">&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">xyz</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">xyz</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">xyz</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="n">xyz</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span><span class="n">xyz</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span><span class="n">xyz</span><span class="p">[</span><span class="mi">5</span><span class="p">]))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;         in Epar : </span><span class="si">%5.3f</span><span class="s1"> </span><span class="si">%5.3f</span><span class="s1"> </span><span class="si">%5.3f</span><span class="s1">&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">xyi</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">xyi</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">xyi</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;         in Eperp: </span><span class="si">%5.3f</span><span class="s1"> </span><span class="si">%5.3f</span><span class="s1"> </span><span class="si">%5.3f</span><span class="s1">&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">xyi</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span><span class="n">xyi</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span><span class="n">xyi</span><span class="p">[</span><span class="mi">5</span><span class="p">]))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">pass</span>
    
    <span class="k">for</span> <span class="n">i2</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">symop</span><span class="p">)):</span>
        <span class="n">flag</span><span class="o">=</span><span class="mi">0</span>
        <span class="k">for</span> <span class="n">i1</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">traop</span><span class="p">)):</span>
            <span class="n">xyz1</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">symop</span><span class="p">[</span><span class="n">i2</span><span class="p">],</span><span class="n">xyz</span><span class="p">)</span>
            <span class="n">xyz2</span><span class="o">=</span><span class="n">xyz1</span><span class="o">+</span><span class="n">traop</span><span class="p">[</span><span class="n">i1</span><span class="p">]</span>
            <span class="n">a</span><span class="o">=</span><span class="n">numericalc12</span><span class="o">.</span><span class="n">projection_numerical</span><span class="p">(</span><span class="n">xyz2</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">xyz2</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">xyz2</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="n">xyz2</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span><span class="n">xyz2</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span><span class="n">xyz2</span><span class="p">[</span><span class="mi">5</span><span class="p">])</span>
            <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">-</span><span class="n">xi</span><span class="p">)</span><span class="o">&lt;</span><span class="n">EPS</span> <span class="ow">and</span> <span class="nb">abs</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">-</span><span class="n">yi</span><span class="p">)</span><span class="o">&lt;</span><span class="n">EPS</span> <span class="ow">and</span> <span class="nb">abs</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">-</span><span class="n">zi</span><span class="p">)</span><span class="o">&lt;</span><span class="n">EPS</span><span class="p">:</span>
                <span class="n">list1</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i2</span><span class="p">)</span>
                <span class="n">flag</span><span class="o">+=</span><span class="mi">1</span>
                <span class="k">break</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">pass</span>
        <span class="k">if</span> <span class="n">flag</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">list2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i2</span><span class="p">)</span>
    
    <span class="n">list1_new</span><span class="o">=</span><span class="n">remove_overlaps_in_a_list</span><span class="p">(</span><span class="n">list1</span><span class="p">)</span>
    <span class="n">list2_new</span><span class="o">=</span><span class="n">remove_overlaps_in_a_list</span><span class="p">(</span><span class="n">list2</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="n">verbose</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;     multiplicity:&#39;</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">list1_new</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;    site symmetry:&#39;</span><span class="p">,</span><span class="n">list1_new</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">pass</span>
    
    <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">symop</span><span class="p">)</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">list1_new</span><span class="p">))</span><span class="o">==</span><span class="mi">1</span><span class="p">:</span>
        <span class="n">list5</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">verbose</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;       left coset:&#39;</span><span class="p">,</span><span class="n">list5</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">pass</span>
    
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># left coset decomposition:</span>
        <span class="n">list4</span><span class="o">=</span><span class="p">[]</span>
        <span class="k">for</span> <span class="n">i2</span> <span class="ow">in</span> <span class="n">list2_new</span><span class="p">:</span>
            <span class="n">list3</span><span class="o">=</span><span class="p">[]</span>
            <span class="k">for</span> <span class="n">i1</span> <span class="ow">in</span> <span class="n">list1_new</span><span class="p">:</span>
                <span class="n">op1</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">symop</span><span class="p">[</span><span class="n">i2</span><span class="p">],</span><span class="n">symop</span><span class="p">[</span><span class="n">i1</span><span class="p">])</span>
                <span class="k">for</span> <span class="n">i3</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">symop</span><span class="p">)):</span>
                    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">op1</span><span class="o">==</span><span class="n">symop</span><span class="p">[</span><span class="n">i3</span><span class="p">]):</span>
                        <span class="n">list3</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i3</span><span class="p">)</span>
                        <span class="k">break</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">pass</span>
            <span class="n">list4</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">list3</span><span class="p">)</span>
        
        <span class="c1">#print(&#39;----------------&#39;)</span>
        <span class="c1">#for i2 in range(len(list4)):</span>
        <span class="c1">#    print(list4[i2])</span>
        <span class="c1">#print(&#39;----------------&#39;)</span>
        
        <span class="k">for</span> <span class="n">i2</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">list4</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
            <span class="n">a</span><span class="o">=</span><span class="n">list4</span><span class="p">[</span><span class="n">i2</span><span class="p">]</span>
            <span class="n">b</span><span class="o">=</span><span class="p">[]</span>
            <span class="n">d</span><span class="o">=</span><span class="p">[]</span>
            <span class="n">list5</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="c1"># symmetry element of identity, symop[0]</span>
            <span class="n">list5</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">list2_new</span><span class="p">[</span><span class="n">i2</span><span class="p">])</span>
            <span class="n">i3</span><span class="o">=</span><span class="n">i2</span><span class="o">+</span><span class="mi">1</span>
            <span class="k">while</span> <span class="n">i3</span><span class="o">&lt;</span><span class="nb">len</span><span class="p">(</span><span class="n">list4</span><span class="p">):</span>
                <span class="n">b</span><span class="o">=</span><span class="n">list4</span><span class="p">[</span><span class="n">i3</span><span class="p">]</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">d</span><span class="p">)</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">find_overlaps</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">)</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
                        <span class="n">d</span><span class="o">=</span><span class="n">a</span><span class="o">+</span><span class="n">b</span>
                        <span class="n">list5</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">list2_new</span><span class="p">[</span><span class="n">i3</span><span class="p">])</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">pass</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">find_overlaps</span><span class="p">(</span><span class="n">d</span><span class="p">,</span><span class="n">b</span><span class="p">)</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
                        <span class="n">d</span><span class="o">=</span><span class="n">d</span><span class="o">+</span><span class="n">b</span>
                        <span class="n">list5</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">list2_new</span><span class="p">[</span><span class="n">i3</span><span class="p">])</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">pass</span>
                <span class="n">i3</span><span class="o">+=</span><span class="mi">1</span>
            <span class="n">b</span><span class="o">=</span><span class="n">remove_overlaps_in_a_list</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">symop</span><span class="p">)</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">list1_new</span><span class="p">))</span><span class="o">==</span><span class="nb">len</span><span class="p">(</span><span class="n">list5</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">verbose</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;       left coset:&#39;</span><span class="p">,</span><span class="n">list5</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">pass</span>
                <span class="k">break</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">pass</span>
    
    <span class="k">return</span> <span class="n">list1_new</span><span class="p">,</span> <span class="n">list5</span></div>


<div class="viewcode-block" id="write_podatm">
<a class="viewcode-back" href="../../../pyqcstrc.ico2.html#pyqcstrc.ico2.occupation_domain.write_podatm">[docs]</a>
<span class="k">def</span> <span class="nf">write_podatm</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">position</span><span class="p">,</span> <span class="n">vlist</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="n">basename</span><span class="o">=</span><span class="s1">&#39;tmp&#39;</span><span class="p">,</span> <span class="n">shift</span><span class="o">=</span><span class="p">[</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">],</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Generate pod and atom files.</span>
<span class="sd">    </span>
<span class="sd">    Args:</span>
<span class="sd">        obj (numpy.ndarray): the occupation domain</span>
<span class="sd">            The shape is (num,4,6,3), where num=numbre_of_tetrahedron.</span>
<span class="sd">        position (numpy.ndarray): 6D coordinates of the position of the occupation domain.</span>
<span class="sd">        vertices (list): </span>
<span class="sd">        vlist (list): </span>
<span class="sd">        path (str): Path of the output files</span>
<span class="sd">        basename (str): Basename of the output files</span>
<span class="sd">        verbose (int):</span>
<span class="sd">            verbose = 0 (silent, default)</span>
<span class="sd">            verbose = 1 (normal)</span>
<span class="sd">    </span>
<span class="sd">    Returns:</span>
<span class="sd">        int: 0 (succeed), 1 (fail)</span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">path</span><span class="p">)</span> <span class="o">==</span> <span class="kc">False</span><span class="p">:</span>
        <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">pass</span>
    
    <span class="k">if</span> <span class="n">obj</span><span class="o">==</span><span class="kc">None</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;no volume obj&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="mi">0</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">fatm</span><span class="o">=</span><span class="nb">open</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1">/</span><span class="si">%s</span><span class="s1">.atm&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">path</span><span class="p">,</span><span class="n">basename</span><span class="p">),</span><span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span>
        <span class="n">fpod</span><span class="o">=</span><span class="nb">open</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1">/</span><span class="si">%s</span><span class="s1">.pod&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">path</span><span class="p">,</span><span class="n">basename</span><span class="p">),</span><span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span>
        
        <span class="n">v</span><span class="o">=</span><span class="n">obj</span>
        
        <span class="n">shft</span><span class="o">=</span><span class="n">shift</span>
        <span class="c1"># .atm file</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">vlist</span><span class="p">)):</span>
            <span class="n">a</span><span class="o">=</span><span class="n">v</span><span class="p">[</span><span class="n">vlist</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">fatm</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%d</span><span class="s1"> </span><span class="se">\&#39;</span><span class="s1">Em</span><span class="se">\&#39;</span><span class="s1"> 1 </span><span class="si">%d</span><span class="s1"> 1 2.0 0. 0. 1.0 0. 0. 0.</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
            <span class="n">fatm</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;x=  </span><span class="si">%4.3f</span><span class="s1">  </span><span class="si">%4.3f</span><span class="s1">  </span><span class="si">%4.3f</span><span class="s1">  </span><span class="si">%4.3f</span><span class="s1">  </span><span class="si">%4.3f</span><span class="s1">  </span><span class="si">%4.3f</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">%</span><span class="p">(</span>\
            <span class="n">numericalc</span><span class="o">.</span><span class="n">numeric_value</span><span class="p">(</span><span class="n">position</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>\
            <span class="n">numericalc</span><span class="o">.</span><span class="n">numeric_value</span><span class="p">(</span><span class="n">position</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span>\
            <span class="n">numericalc</span><span class="o">.</span><span class="n">numeric_value</span><span class="p">(</span><span class="n">position</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span>\
            <span class="n">numericalc</span><span class="o">.</span><span class="n">numeric_value</span><span class="p">(</span><span class="n">position</span><span class="p">[</span><span class="mi">3</span><span class="p">]),</span>\
            <span class="n">numericalc</span><span class="o">.</span><span class="n">numeric_value</span><span class="p">(</span><span class="n">position</span><span class="p">[</span><span class="mi">4</span><span class="p">]),</span>\
            <span class="n">numericalc</span><span class="o">.</span><span class="n">numeric_value</span><span class="p">(</span><span class="n">position</span><span class="p">[</span><span class="mi">5</span><span class="p">])))</span>
            <span class="n">fatm</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;xe1= 1. 0.  0. 0.  0. 0. u1=0.0            5f</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">fatm</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;xe2= 1. 0. -1. 0. -1. 0. u2=0.0            3f</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">fatm</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;xe3= 1. 0.  0. 0. -1. 0. u3=0.0            2f</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">fatm</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;xi=  </span><span class="si">%8.6f</span><span class="s1">  </span><span class="si">%8.6f</span><span class="s1">  </span><span class="si">%8.6f</span><span class="s1">  </span><span class="si">%8.6f</span><span class="s1">  </span><span class="si">%8.6f</span><span class="s1">  </span><span class="si">%8.6f</span><span class="s1">  v=1.0</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">%</span><span class="p">(</span>\
            <span class="n">numericalc</span><span class="o">.</span><span class="n">numeric_value</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">+</span><span class="n">shft</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>\
            <span class="n">numericalc</span><span class="o">.</span><span class="n">numeric_value</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">+</span><span class="n">shft</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>\
            <span class="n">numericalc</span><span class="o">.</span><span class="n">numeric_value</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="o">+</span><span class="n">shft</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>\
            <span class="n">numericalc</span><span class="o">.</span><span class="n">numeric_value</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span><span class="o">+</span><span class="n">shft</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span>\
            <span class="n">numericalc</span><span class="o">.</span><span class="n">numeric_value</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span><span class="o">+</span><span class="n">shft</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span>\
            <span class="n">numericalc</span><span class="o">.</span><span class="n">numeric_value</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="mi">5</span><span class="p">])</span><span class="o">+</span><span class="n">shft</span><span class="p">[</span><span class="mi">5</span><span class="p">]))</span>
            <span class="n">fatm</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;isyd=1</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fatm</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    
        <span class="c1"># .pod file</span>
        <span class="n">fpod</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;nsymo=4 icent=1 brv=</span><span class="se">\&#39;</span><span class="s1">p</span><span class="se">\&#39;</span><span class="s1"> io=</span><span class="si">%d</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">%</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">vlist</span><span class="p">)))</span>
        <span class="n">fpod</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;symmetry operator</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fpod</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;x,z,t,u,v,y            5f</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fpod</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;-x,-y,-v,-u,-t,-z      2f</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fpod</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;-v,-y,t,z,-u,-x        2f</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fpod</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;y,z,x,v,-t,-u          3f</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i1</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">vlist</span><span class="p">)):</span>
            <span class="n">a</span><span class="o">=</span><span class="n">v</span><span class="p">[</span><span class="n">vlist</span><span class="p">[</span><span class="n">i1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">tmp2</span><span class="o">=</span><span class="p">[</span><span class="n">vlist</span><span class="p">[</span><span class="n">i1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">i2</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">vlist</span><span class="p">[</span><span class="n">i1</span><span class="p">])):</span>
                <span class="n">counter</span><span class="o">=</span><span class="mi">0</span>
                <span class="k">for</span> <span class="n">i3</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">tmp2</span><span class="p">)):</span>
                    <span class="k">if</span> <span class="n">vlist</span><span class="p">[</span><span class="n">i1</span><span class="p">][</span><span class="n">i2</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span><span class="o">==</span><span class="n">tmp2</span><span class="p">[</span><span class="n">i3</span><span class="p">]:</span>
                        <span class="n">counter</span><span class="o">+=</span><span class="mi">1</span>
                        <span class="k">break</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">pass</span>
                <span class="k">if</span> <span class="n">counter</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
                    <span class="n">tmp2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">vlist</span><span class="p">[</span><span class="n">i1</span><span class="p">][</span><span class="n">i2</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">pass</span>
            <span class="n">tmp1</span><span class="o">=</span><span class="p">[]</span>
            <span class="k">for</span> <span class="n">i2</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">vlist</span><span class="p">[</span><span class="n">i1</span><span class="p">])):</span>
                <span class="k">for</span> <span class="n">i3</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">tmp2</span><span class="p">)):</span>
                    <span class="k">if</span> <span class="n">vlist</span><span class="p">[</span><span class="n">i1</span><span class="p">][</span><span class="n">i2</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span><span class="o">==</span><span class="n">tmp2</span><span class="p">[</span><span class="n">i3</span><span class="p">]:</span>
                        <span class="n">tmp1</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i3</span><span class="p">)</span>
                        <span class="k">break</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">pass</span>
            <span class="n">fpod</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%d</span><span class="s1"> </span><span class="si">%d</span><span class="s1"> </span><span class="si">%d</span><span class="s1"> </span><span class="se">\&#39;</span><span class="s1">comment</span><span class="se">\&#39;\n</span><span class="s1">&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">i1</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">tmp2</span><span class="p">),</span><span class="mi">2</span><span class="p">))</span>
            <span class="k">for</span> <span class="n">i2</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">tmp2</span><span class="p">)):</span>
                <span class="n">b</span><span class="o">=</span><span class="n">v</span><span class="p">[</span><span class="n">tmp2</span><span class="p">[</span><span class="n">i2</span><span class="p">]]</span>
                <span class="n">fpod</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;ej=  </span><span class="si">%8.6f</span><span class="s1"> </span><span class="si">%8.6f</span><span class="s1"> </span><span class="si">%8.6f</span><span class="s1"> </span><span class="si">%8.6f</span><span class="s1"> </span><span class="si">%8.6f</span><span class="s1"> </span><span class="si">%8.6f</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">%</span><span class="p">(</span>\
                <span class="n">numericalc</span><span class="o">.</span><span class="n">numeric_value</span><span class="p">(</span><span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">-</span><span class="n">numericalc</span><span class="o">.</span><span class="n">numeric_value</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>\
                <span class="n">numericalc</span><span class="o">.</span><span class="n">numeric_value</span><span class="p">(</span><span class="n">b</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="n">numericalc</span><span class="o">.</span><span class="n">numeric_value</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span>\
                <span class="n">numericalc</span><span class="o">.</span><span class="n">numeric_value</span><span class="p">(</span><span class="n">b</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="o">-</span><span class="n">numericalc</span><span class="o">.</span><span class="n">numeric_value</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span>\
                <span class="n">numericalc</span><span class="o">.</span><span class="n">numeric_value</span><span class="p">(</span><span class="n">b</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span><span class="o">-</span><span class="n">numericalc</span><span class="o">.</span><span class="n">numeric_value</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="mi">3</span><span class="p">]),</span>\
                <span class="n">numericalc</span><span class="o">.</span><span class="n">numeric_value</span><span class="p">(</span><span class="n">b</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span><span class="o">-</span><span class="n">numericalc</span><span class="o">.</span><span class="n">numeric_value</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="mi">4</span><span class="p">]),</span>\
                <span class="n">numericalc</span><span class="o">.</span><span class="n">numeric_value</span><span class="p">(</span><span class="n">b</span><span class="p">[</span><span class="mi">5</span><span class="p">])</span><span class="o">-</span><span class="n">numericalc</span><span class="o">.</span><span class="n">numeric_value</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="mi">5</span><span class="p">])))</span>
            <span class="n">fpod</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;nth= </span><span class="si">%d</span><span class="s1">&#39;</span><span class="o">%</span><span class="p">(</span><span class="nb">int</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">vlist</span><span class="p">[</span><span class="n">i1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">3</span><span class="p">)))</span>
            <span class="k">for</span> <span class="n">i2</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">tmp1</span><span class="p">)):</span>
                <span class="n">fpod</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39; </span><span class="si">%d</span><span class="s1">&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">tmp1</span><span class="p">[</span><span class="n">i2</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
            <span class="n">fpod</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">100000000000000000000000000000000000000000000000000000000000</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">fpod</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;000000000000000000000000000000000000000000000000000000000000</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fpod</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;    written in </span><span class="si">%s</span><span class="s1">/</span><span class="si">%s</span><span class="s1">.atm&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">path</span><span class="p">,</span><span class="n">basename</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;    written in </span><span class="si">%s</span><span class="s1">/</span><span class="si">%s</span><span class="s1">.pod&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">path</span><span class="p">,</span><span class="n">basename</span><span class="p">))</span>
    <span class="k">return</span> <span class="mi">0</span></div>





<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    
    <span class="c1"># import asymmetric part of STRT OD(occupation domain) located at origin,0,0,0,0,0,0.</span>
    <span class="n">strt_asym</span> <span class="o">=</span> <span class="n">read_xyz</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="s1">&#39;../xyz&#39;</span><span class="p">,</span><span class="n">basename</span><span class="o">=</span><span class="s1">&#39;strt_aysmmetric&#39;</span><span class="p">)</span>
    <span class="n">write</span><span class="p">(</span><span class="n">obj</span><span class="o">=</span><span class="n">strt_asym</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="n">basename</span> <span class="o">=</span> <span class="s1">&#39;obj_seed&#39;</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;vesta&#39;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;k&#39;</span><span class="p">)</span>
    
    <span class="c1"># generat STRT OD located at 0,0,0,0,0,0 by symmetric operations (m-3-5).</span>
    <span class="n">pos0</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],[</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],[</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],[</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],[</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],[</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>
    <span class="n">strt</span> <span class="o">=</span> <span class="n">symmetric</span><span class="p">(</span><span class="n">asymmetric_part_obj</span> <span class="o">=</span> <span class="n">strt_asym</span><span class="p">,</span> <span class="n">position</span> <span class="o">=</span> <span class="n">pos0</span><span class="p">)</span>
    
    <span class="c1"># move STRT OD to a position 1 1 1 0 -1 0.</span>
    <span class="n">pos_b1</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],[</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],[</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],[</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],[</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span> <span class="c1"># b_1</span>
    <span class="n">strt_pos1</span><span class="o">=</span><span class="n">shift</span><span class="p">(</span><span class="n">obj</span> <span class="o">=</span> <span class="n">strt_sym</span><span class="p">,</span> <span class="n">shift</span> <span class="o">=</span> <span class="n">pos_b1</span><span class="p">)</span>
    <span class="n">write</span><span class="p">(</span><span class="n">pod</span><span class="o">=</span><span class="n">strt_pos1</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="n">basename</span><span class="o">=</span><span class="s1">&#39;obj_strt&#39;</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;xyz&#39;</span><span class="p">)</span>
    <span class="n">write</span><span class="p">(</span><span class="n">obj</span><span class="o">=</span><span class="n">strt_pos1</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="n">basename</span><span class="o">=</span><span class="s1">&#39;obj_strt&#39;</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;vesta&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
    
    <span class="c1"># intersection of &quot;asymmetric part of strt&quot; and &quot;strt at position pos_b1&quot;</span>
    <span class="c1">#    flag = 0,    with rough intersection chacking (faster)</span>
    <span class="c1">#    flag = 1, without rough intersection chacking</span>
    <span class="c1">#twoODs=TWO_ODs(pod1=strt_asym, pod2=strt_pos1, path=&#39;.&#39;,filename=&#39;common.xyz&#39;,flag=0,verbose=0)</span>
    <span class="c1">#intersection=Intersection(pod1=tmp1.reshape(1,4,6,3), pod2=tmp2.reshape(1,4,6,3), path=&#39;.&#39;,filename=&#39;common.xyz&#39;,flag=0,verbose=0)</span>
    <span class="c1">#common_part=twoODs.intersection()</span>
    
    <span class="c1"># export common_part in VESTA formated file.</span>
    <span class="c1">#write(obj=common_part, path=&#39;.&#39;, basename=&#39;common&#39;, format=&#39;vesta&#39;, color=&#39;r&#39;)</span>
    
    
</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright Tsunetomo Yamada.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>